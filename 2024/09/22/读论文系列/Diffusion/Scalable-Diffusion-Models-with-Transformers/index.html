<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><title>Scalable Diffusion Models with Transformers | Orion Blog</title><meta name="author" content="Orion"><meta name="description" content="Here's Orion"><meta name="keywords" content="技术博客,Orion,BUPT北京邮电大学,本科生,人工智能,AI算法工程师,机器学习,深度学习,计算机视觉,自然语言处理,NLP,CV,大模型"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="icon" href="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409190134514.png"><link rel="preload" as="image" href="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409181543316.png"><link rel="preconnect" href="https://s4.zstatic.net"><script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" media="only x" onload='this.onload=null,this.media="all"'><link rel="preconnect" href="https://fonts.googleapis.cn"><link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" media="only x" onload='this.onload=null,this.media="all"'><script>const mixins={}</script><script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"><script src="/js/lib/highlight.js"></script><script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css"><script src="/js/lib/math.js"></script><script src="/js/lib/preview.js"></script><script src="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.min.js"></script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.min.css"><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline-meta.min.css"><script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script><link rel="stylesheet" href="/css/main.css"><link rel="preconnect" href="https://static-argvchs.netlify.app"><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:yellow;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body><div id="layout"><transition name="fade"><div id="loading" v-show="loading"><div id="loading-circle"><h2>LOADING</h2><p>加载过慢请开启缓存 浏览器默认开启</p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409201808995.gif"></div></div></transition><div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}"><nav id="desktop-menu"><a class="title" href="/"><span>ORION BLOG</span></a><a href="/"><i class="fa-solid fa-house fa-fw"></i> <span>&ensp;Home</span></a><a href="/about"><i class="fa-solid fa-id-card fa-fw"></i> <span>&ensp;About</span></a><a href="/archives"><i class="fa-solid fa-box-archive fa-fw"></i> <span>&ensp;Archives</span></a><a href="/categories"><i class="fa-solid fa-bookmark fa-fw"></i> <span>&ensp;Categories</span></a><a href="/tags"><i class="fa-solid fa-tags fa-fw"></i> <span>&ensp;Tags</span></a></nav><nav id="mobile-menu"><div class="title" @click="showMenuItems = !showMenuItems"><i class="fa-solid fa-bars fa-fw"></i> <span>&emsp;ORION BLOG</span></div><transition name="slide"><div class="items" v-show="showMenuItems"><a href="/"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-house fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Home</div></div></a><a href="/about"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-id-card fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">About</div></div></a><a href="/archives"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-box-archive fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Archives</div></div></a><a href="/categories"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-bookmark fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Categories</div></div></a><a href="/tags"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-tags fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Tags</div></div></a></div></transition></nav></div><transition name="fade"><div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div></transition><div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'"><div class="article"><div><h1>Scalable Diffusion Models with Transformers</h1></div><div class="info"><span class="date"><span class="icon"><i class="fa-solid fa-calendar fa-fw"></i></span> 2024/9/22</span><span class="category"><a href="/categories/%E8%AF%BB%E8%AE%BA%E6%96%87%E7%B3%BB%E5%88%97/"><span class="icon"><i class="fa-solid fa-bookmark fa-fw"></i></span> 读论文系列</a></span><span class="tags"><span class="icon"><i class="fa-solid fa-tags fa-fw"></i></span> <span class="tag"><a href="/tags/diffusion/" style="color:#ffa2c4">diffusion</a></span></span></div><div class="content" v-pre><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409221812745.png" alt="image-20240922181257708"></p><p>论文发布时间：2023.3.2</p><p>发布会议/期刊：ICCV</p><span id="more"></span><h1><span id="abstract">Abstract</span><a href="#abstract" class="header-anchor"></a></h1><ul><li>利用transformer架构替代了U-Net，名为Diffusion Transformers (DiTs)。</li><li>通过增加transformers的深度和宽度或者输入tokends，有更高Gflops的DiTs却始终有较低的FID。</li><li>DiT-XL/2在class-conditional ImageNet 512×512 and 256×256 benchmarks上取得SOTA。</li></ul><h1><span id="introduction">Introduction</span><a href="#introduction" class="header-anchor"></a></h1><h3><span id="mu-biao">目标</span><a href="#mu-biao" class="header-anchor"></a></h3><p>将普遍使用于扩散模型的骨干网络U-Net替换为Transformer，并探讨其scaling等性能</p><h3><span id="dong-ji">动机</span><a href="#dong-ji" class="header-anchor"></a></h3><ol type="1"><li>Transformers已经得到了广泛的应用，而图像生成模型却仍然抵制这一趋势，在许多diffusion模型中还在使用U-Net作为backbone。</li><li>U-Net的inductive bias对于diffusion的表现并不重要，可以被标准化的架构替代，并且保留scalability, robustness and efficiency，并且标准化架构更有利于跨领域研究</li></ol><h3><span id="jie-jue-fang-an">解决方案</span><a href="#jie-jue-fang-an" class="header-anchor"></a></h3><ol type="1"><li>利用了四种不同的方案训练diffusion transformer，探讨不同方案的性能。</li></ol><h1><span id="diffusion-transformers">Diffusion Transformers</span><a href="#diffusion-transformers" class="header-anchor"></a></h1><h2><span id="preliminaries">Preliminaries</span><a href="#preliminaries" class="header-anchor"></a></h2><h3><span id="diffusion-formulation">Diffusion formulation</span><a href="#diffusion-formulation" class="header-anchor"></a></h3><p>扩散模型（Diffusion Models），特别是去噪扩散概率模型（Denoising Diffusion Probabilistic Models, 简称DDPMs），是一类生成模型，通过逐步添加噪声到真实数据并学习逆过程来生成新数据。</p><h4><span id="1-qian-xiang-kuo-san-guo-cheng">1. 前向扩散过程</span><a href="#1-qian-xiang-kuo-san-guo-cheng" class="header-anchor"></a></h4><p>扩散模型假设存在一个<strong>前向扩散过程</strong>，该过程逐步将噪声应用于真实数据<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.375ex" xmlns="http://www.w3.org/2000/svg" width="2.282ex" height="1.375ex" role="img" focusable="false" viewbox="0 -442 1008.6 607.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></g></svg></mjx-container></span>。具体来说，前向过程在每个时间步<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewbox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></svg></mjx-container></span>将数据<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.471ex" xmlns="http://www.w3.org/2000/svg" width="4.104ex" height="1.471ex" role="img" focusable="false" viewbox="0 -442 1813.9 650"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g></g></g></svg></mjx-container></span>添加少量高斯噪声，生成<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="2.059ex" height="1.357ex" role="img" focusable="false" viewbox="0 -442 910.3 599.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></g></svg></mjx-container></span>：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="34.494ex" height="2.925ex" role="img" focusable="false" viewbox="0 -1042.9 15246.5 1292.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389 373 390 377 395T388 406 404 418Q438 442 450 442 454 442 457 439T460 434Q460 425 391 149 320-135 320-139 320-147 365-148H390Q396-156 396-157T393-175Q389-188 383-194H370Q339-192 262-192 234-192 211-192T174-192 157-193Q143-193 143-185 143-182 145-170 149-154 152-151T172-148Q220-148 230-141 238-136 258-53T279 32Q279 33 272 29 224-10 172-10 117-10 75 30T33 157ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mo" transform="translate(460,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(849,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(1759.3,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(2037.3,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g><g data-mml-node="mo" transform="translate(3045.8,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3712.6,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4768.4,0)"><g data-mml-node="mi"><path data-c="4E" d="M343 705Q358 705 358 698 360 696 370 658T411 524 484 319Q536 174 590 82L595 73 615 152Q646 274 683 407 729 571 752 637T799 727Q852 780 937 788 939 788 947 788T958 789H962Q979 789 979 765 979 722 951 692 942 683 924 683 888 681 859 672T818 654 803 639Q784 608 708 322T631 15Q631 14 630 15 630 17 629 15 628 14 628 12 621-4 601-17T560-31Q550-31 546-28T530-7Q484 67 458 123T398 272Q352 392 314 514L306 535V534Q306 533 296 488T272 379 234 239 185 100 127-7 61-50Q34-50 4-34T-27 8Q-27 33-12 61T18 90Q21 90 36 77T87 57H92Q109 57 123 78T162 173Q206 299 232 417T265 599 276 667Q284 681 304 693T343 705Z"/></g></g><g data-mml-node="mo" transform="translate(5747.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(6136.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(7046.6,0)"><path data-c="3B" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310 96 327 78 370ZM78 60Q78 85 94 103T137 121Q202 121 202 8 202-44 183-94T144-169 118-194Q115-194 106-186T95-174Q94-171 107-155T137-107 160-38Q161-32 162-22T165-4 165 4Q165 5 161 4T142 0Q110 0 94 18T78 60Z"/></g><g data-mml-node="msqrt" transform="translate(7491.3,0)"><g transform="translate(1020,0)"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(347.8,3) translate(-250 0)"><path data-c="AF" d="M69 544V590H430V544H69Z"/></g></g></g><g data-mml-node="mi" transform="translate(673,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,132.9)"><path data-c="221A" d="M263 249Q264 249 315 130T417-108 470-228L725 302Q981 837 982 839 989 850 1001 850 1008 850 1013 844T1020 832V826L741 243Q645 43 540-176 479-303 469-324T453-348Q449-350 436-350L424-349 315-96Q206 156 205 156L171 130Q138 104 137 104L111 130 263 249Z"/></g><rect width="978.3" height="60" x="1020" y="922.9"/></g><g data-mml-node="msub" transform="translate(9489.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g><g data-mml-node="mo" transform="translate(10498.1,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(10942.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mn" transform="translate(11331.8,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g><g data-mml-node="mo" transform="translate(12054,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(13054.2,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(347.8,3) translate(-250 0)"><path data-c="AF" d="M69 544V590H430V544H69Z"/></g></g></g><g data-mml-node="mi" transform="translate(673,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(14032.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(14421.5,0)"><g data-mml-node="mi"><path data-c="1D408" d="M397 0Q370 3 218 3 65 3 38 0H25V62H139V624H25V686H38Q65 683 218 683 370 683 397 686H410V624H296V62H410V0H397Z"/></g></g><g data-mml-node="mo" transform="translate(14857.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="2.213ex" height="1.925ex" role="img" focusable="false" viewbox="0 -693 978.3 850.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(347.8,3) translate(-250 0)"><path data-c="AF" d="M69 544V590H430V544H69Z"/></g></g></g><g data-mml-node="mi" transform="translate(673,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></g></svg></mjx-container></span>是预先设定的超参数，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="0.986ex" height="1.552ex" role="img" focusable="false" viewbox="0 -686 436 686"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D408" d="M397 0Q370 3 218 3 65 3 38 0H25V62H139V624H25V686H38Q65 683 218 683 370 683 397 686H410V624H296V62H410V0H397Z"/></g></g></g></g></svg></mjx-container></span>是单位矩阵。</p><p>通过重参数化技巧，我们可以表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="2.059ex" height="1.357ex" role="img" focusable="false" viewbox="0 -442 910.3 599.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></g></svg></mjx-container></span>为：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.491ex" xmlns="http://www.w3.org/2000/svg" width="24.747ex" height="2.851ex" role="img" focusable="false" viewbox="0 -1042.9 10938.1 1260"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(1188,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msqrt" transform="translate(2243.8,0)"><g transform="translate(1020,0)"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(347.8,3) translate(-250 0)"><path data-c="AF" d="M69 544V590H430V544H69Z"/></g></g></g><g data-mml-node="mi" transform="translate(673,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,132.9)"><path data-c="221A" d="M263 249Q264 249 315 130T417-108 470-228L725 302Q981 837 982 839 989 850 1001 850 1008 850 1013 844T1020 832V826L741 243Q645 43 540-176 479-303 469-324T453-348Q449-350 436-350L424-349 315-96Q206 156 205 156L171 130Q138 104 137 104L111 130 263 249Z"/></g><rect width="978.3" height="60" x="1020" y="922.9"/></g><g data-mml-node="msub" transform="translate(4242.1,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g><g data-mml-node="mo" transform="translate(5472.9,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="msqrt" transform="translate(6473.1,0)"><g transform="translate(1020,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(1722.4,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(347.8,3) translate(-250 0)"><path data-c="AF" d="M69 544V590H430V544H69Z"/></g></g></g><g data-mml-node="mi" transform="translate(673,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,132.9)"><path data-c="221A" d="M263 249Q264 249 315 130T417-108 470-228L725 302Q981 837 982 839 989 850 1001 850 1008 850 1013 844T1020 832V826L741 243Q645 43 540-176 479-303 469-324T453-348Q449-350 436-350L424-349 315-96Q206 156 205 156L171 130Q138 104 137 104L111 130 263 249Z"/></g><rect width="2700.7" height="60" x="1020" y="922.9"/></g><g data-mml-node="msub" transform="translate(10193.8,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></g></svg></mjx-container></span></p><p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="11.8ex" height="2.351ex" role="img" focusable="false" viewbox="0 -789 5215.5 1039"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(1022,0)"><path data-c="223C" d="M55 166Q55 241 101 304T222 367Q260 367 296 349T362 304 421 252 484 208 554 189Q616 189 655 236T694 338Q694 350 698 358T708 367Q722 367 722 334 722 260 677 197T562 134H554Q517 134 481 152T414 196 355 248 292 293 223 311Q179 311 145 286 109 257 96 218T80 156 69 133Q55 133 55 166Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2077.8,0)"><g data-mml-node="mi"><path data-c="4E" d="M343 705Q358 705 358 698 360 696 370 658T411 524 484 319Q536 174 590 82L595 73 615 152Q646 274 683 407 729 571 752 637T799 727Q852 780 937 788 939 788 947 788T958 789H962Q979 789 979 765 979 722 951 692 942 683 924 683 888 681 859 672T818 654 803 639Q784 608 708 322T631 15Q631 14 630 15 630 17 629 15 628 14 628 12 621-4 601-17T560-31Q550-31 546-28T530-7Q484 67 458 123T398 272Q352 392 314 514L306 535V534Q306 533 296 488T272 379 234 239 185 100 127-7 61-50Q34-50 4-34T-27 8Q-27 33-12 61T18 90Q21 90 36 77T87 57H92Q109 57 123 78T162 173Q206 299 232 417T265 599 276 667Q284 681 304 693T343 705Z"/></g></g><g data-mml-node="mo" transform="translate(3056.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mn" transform="translate(3445.8,0)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g><g data-mml-node="mo" transform="translate(3945.8,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4390.5,0)"><g data-mml-node="mi"><path data-c="1D408" d="M397 0Q370 3 218 3 65 3 38 0H25V62H139V624H25V686H38Q65 683 218 683 370 683 397 686H410V624H296V62H410V0H397Z"/></g></g><g data-mml-node="mo" transform="translate(4826.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>是从标准正态分布中采样的噪声。</p><h4><span id="2-ni-xiang-kuo-san-guo-cheng">2. 逆向扩散过程</span><a href="#2-ni-xiang-kuo-san-guo-cheng" class="header-anchor"></a></h4><p>扩散模型的核心在于学习一个<strong>逆向过程</strong>，即从噪声数据逐步去噪，恢复出真实数据。逆向过程定义为：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="31.14ex" height="2.351ex" role="img" focusable="false" viewbox="0 -789 13763.9 1039"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(917.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1306.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(3120.6,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(3398.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(4308.8,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4975.6,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6031.4,0)"><g data-mml-node="mi"><path data-c="4E" d="M343 705Q358 705 358 698 360 696 370 658T411 524 484 319Q536 174 590 82L595 73 615 152Q646 274 683 407 729 571 752 637T799 727Q852 780 937 788 939 788 947 788T958 789H962Q979 789 979 765 979 722 951 692 942 683 924 683 888 681 859 672T818 654 803 639Q784 608 708 322T631 15Q631 14 630 15 630 17 629 15 628 14 628 12 621-4 601-17T560-31Q550-31 546-28T530-7Q484 67 458 123T398 272Q352 392 314 514L306 535V534Q306 533 296 488T272 379 234 239 185 100 127-7 61-50Q34-50 4-34T-27 8Q-27 33-12 61T18 90Q21 90 36 77T87 57H92Q109 57 123 78T162 173Q206 299 232 417T265 599 276 667Q284 681 304 693T343 705Z"/></g></g><g data-mml-node="mo" transform="translate(7010.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(7399.4,0)"><g data-mml-node="mi"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g><g data-mml-node="mi" transform="translate(636,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(8417,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(8806,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(9716.3,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(10105.3,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="msub" transform="translate(10550,0)"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299 56 644 55 658Q55 677 60 681 63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294 189L293 494Q314 465 345 422 400 346 400 340 400 338 399 337L154 57Q407 57 428 58 476 60 508 68T551 83 575 103Q595 125 608 162T624 225L626 251H666V247Z"/></g><g data-mml-node="mi" transform="translate(755,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(11686.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(12075.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(12985.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(13374.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>这里，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="2.302ex" height="1.489ex" role="img" focusable="false" viewbox="0 -442 1017.6 658"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g><g data-mml-node="mi" transform="translate(636,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="2.572ex" height="1.901ex" role="img" focusable="false" viewbox="0 -683 1136.6 840.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299 56 644 55 658Q55 677 60 681 63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294 189L293 494Q314 465 345 422 400 346 400 340 400 338 399 337L154 57Q407 57 428 58 476 60 508 68T551 83 575 103Q595 125 608 162T624 225L626 251H666V247Z"/></g><g data-mml-node="mi" transform="translate(755,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>是由神经网络参数化的均值和协方差，用于预测下一步的均值和协方差。</p><h4><span id="3-mo-xing-xun-lian">3. 模型训练</span><a href="#3-mo-xing-xun-lian" class="header-anchor"></a></h4><p>扩散模型通过最大化数据的变分下界（variational lower bound）来训练，其损失函数主要由以下两部分组成：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-2.641ex" xmlns="http://www.w3.org/2000/svg" width="59.63ex" height="4.791ex" role="img" focusable="false" viewbox="0 -950 26356.5 2117.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="4C" d="M62-22T47-22 32-11Q32-1 56 24T83 55Q113 96 138 172T180 320 234 473 323 609Q364 649 419 677T531 705Q559 705 578 696T604 671 615 645 618 623V611Q618 582 615 571T598 548Q581 531 558 520T518 509Q503 509 503 520 503 523 505 536T507 560Q507 590 494 610T452 630Q423 630 410 617 367 578 333 492T271 301 233 170Q211 123 204 112L198 103 224 102Q281 102 369 79T509 52H523Q535 64 544 87T579 128Q616 152 641 152 656 152 656 142 656 101 588 40T433-22Q381-22 289 1T156 28L141 29 131 20Q111 0 87-11Z"/></g></g><g data-mml-node="mo" transform="translate(690,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1079,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g><g data-mml-node="mo" transform="translate(1548,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2214.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mo" transform="translate(3270.6,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(4215.2,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(5493.2,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(5659.9,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(6162.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(6551.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g><g data-mml-node="mo" transform="translate(7560.4,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(7838.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g><g data-mml-node="mo" transform="translate(8847,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(9458.2,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="munder" transform="translate(10458.4,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761 1235 809 1174 838T1033 881 882 898 699 902H574 543 251L259 891Q722 258 724 252 725 250 724 246 721 243 460-56L196-356Q196-357 407-357 459-357 548-357T676-358Q812-358 896-353T1063-332 1204-283 1307-196Q1328-170 1348-124H1388Q1388-125 1381-145T1356-210 1325-294L1267-449 666-450Q64-450 61-448 55-446 55-439 55-437 57-433L590 177Q590 178 557 222T452 366 322 544L56 909 55 924Q55 945 60 948Z"/></g><g data-mml-node="mi" transform="translate(594.4,-1059.6) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="msub" transform="translate(12069.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="44" d="M37 475Q19 475 19 487 19 536 103 604T327 682H356Q386 683 408 683H419Q475 683 506 681T582 668 667 633Q766 571 766 450 766 365 723 287T611 152 455 57 279 6Q248 1 160 0 148 0 131 0T108-1Q72-1 72 11 72 24 90 40T133 64L144 68 152 88Q247 328 272 587 275 613 272 613 272 613 269 613 225 610 195 602T149 579 129 556 119 532Q118 530 116 525T113 518Q102 502 80 490T37 475ZM665 407Q665 596 412 613 403 614 383 614 370 614 370 612 370 598 363 542T323 357 242 103L228 69H265Q391 73 481 119 536 148 575 188T633 268 658 338 665 392V407Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(804,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637 205 637 198 638T191 647Q191 649 193 661 199 681 203 682 205 683 214 683H219Q260 681 355 681 389 681 418 681T463 682 483 682Q500 682 500 674 500 669 497 660 496 658 496 654T495 648 493 644 490 641 486 639 479 638 470 637 456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620 692 635 667 637 651 637 651 648 651 650 654 662T659 677Q662 682 676 682 680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672 889 650 881 642 878 637 862 637 787 632 726 586 710 576 656 534T556 455L509 418 518 396Q527 374 546 329T581 244Q656 67 661 61 663 59 666 57 680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3 503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71 544 75 517 141T485 216L427 354 359 301 291 248 268 155Q245 63 245 58 245 51 253 49T303 46H334Q340 37 340 35 340 19 333 5 328 0 317 0 314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 147 65 216 339T285 628Z"/></g><g data-mml-node="mi" transform="translate(889,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641 191 643 191 649 191 673 202 682 204 683 217 683 271 680 344 680 485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628 387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54 478 72 522 106 564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203 583 83 557 9Q555 4 553 3T537 0 494-1Q483-1 418-1T294 0H116Q32 0 32 10 32 17 34 24 39 43 44 45 48 46 59 46H65Q92 46 125 49 139 52 144 61 147 65 216 339T285 628Q285 635 228 637Z"/></g></g></g><g data-mml-node="mrow" transform="translate(14199.9,0)"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msup" transform="translate(389,0)"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389 373 390 377 395T388 406 404 418Q438 442 450 442 454 442 457 439T460 434Q460 425 391 149 320-135 320-139 320-147 365-148H390Q396-156 396-157T393-175Q389-188 383-194H370Q339-192 262-192 234-192 211-192T174-192 157-193Q143-193 143-185 143-182 145-170 149-154 152-151T172-148Q220-148 230-141 238-136 258-53T279 32Q279 33 272 29 224-10 172-10 117-10 75 30T33 157ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mo" transform="translate(543.7,413) scale(0.707)"><path data-c="2217" d="M229 286Q216 420 216 436 216 454 240 464 241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315 420 312 357 282T289 250L355 219 425 184Q434 175 434 161 434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63 283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127 106 124 100 124 87 124 76 134T64 161Q64 166 64 169T67 175 72 181 81 188 94 195 113 204 138 215 170 230 210 250L74 315Q65 324 65 338 65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"/></g></g><g data-mml-node="mo" transform="translate(1336.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1725.3,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(3539.2,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(3817.2,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(4727.5,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="msub" transform="translate(5172.1,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g><g data-mml-node="mo" transform="translate(6180.7,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(6569.7,0)"><path data-c="2225" d="M133 736Q138 750 153 750 164 750 170 739 172 735 172 250T170-239Q164-250 152-250 144-250 138-244L137-243Q133-241 133-179T132 250Q132 731 133 736ZM329 739Q334 750 346 750 353 750 361 744L362 743Q366 741 366 679T367 250 367-178 362-243L361-244Q355-250 347-250 335-250 329-239 327-235 327 250T329 739Z"/></g><g data-mml-node="msub" transform="translate(7069.7,0)"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(7987.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(8376.3,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(10190.3,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(10468.3,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(11378.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(11767.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></g></svg></mjx-container></span></p><p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.339ex" xmlns="http://www.w3.org/2000/svg" width="4.444ex" height="1.885ex" role="img" focusable="false" viewbox="0 -683 1964.2 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="44" d="M37 475Q19 475 19 487 19 536 103 604T327 682H356Q386 683 408 683H419Q475 683 506 681T582 668 667 633Q766 571 766 450 766 365 723 287T611 152 455 57 279 6Q248 1 160 0 148 0 131 0T108-1Q72-1 72 11 72 24 90 40T133 64L144 68 152 88Q247 328 272 587 275 613 272 613 272 613 269 613 225 610 195 602T149 579 129 556 119 532Q118 530 116 525T113 518Q102 502 80 490T37 475ZM665 407Q665 596 412 613 403 614 383 614 370 614 370 612 370 598 363 542T323 357 242 103L228 69H265Q391 73 481 119 536 148 575 188T633 268 658 338 665 392V407Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(804,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637 205 637 198 638T191 647Q191 649 193 661 199 681 203 682 205 683 214 683H219Q260 681 355 681 389 681 418 681T463 682 483 682Q500 682 500 674 500 669 497 660 496 658 496 654T495 648 493 644 490 641 486 639 479 638 470 637 456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620 692 635 667 637 651 637 651 648 651 650 654 662T659 677Q662 682 676 682 680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672 889 650 881 642 878 637 862 637 787 632 726 586 710 576 656 534T556 455L509 418 518 396Q527 374 546 329T581 244Q656 67 661 61 663 59 666 57 680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3 503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71 544 75 517 141T485 216L427 354 359 301 291 248 268 155Q245 63 245 58 245 51 253 49T303 46H334Q340 37 340 35 340 19 333 5 328 0 317 0 314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 147 65 216 339T285 628Z"/></g><g data-mml-node="mi" transform="translate(889,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641 191 643 191 649 191 673 202 682 204 683 217 683 271 680 344 680 485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628 387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54 478 72 522 106 564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203 583 83 557 9Q555 4 553 3T537 0 494-1Q483-1 418-1T294 0H116Q32 0 32 10 32 17 34 24 39 43 44 45 48 46 59 46H65Q92 46 125 49 139 52 144 61 147 65 216 339T285 628Q285 635 228 637Z"/></g></g></g></g></g></svg></mjx-container></span>表示KL散度，用于衡量真实后验<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="2.143ex" height="2.004ex" role="img" focusable="false" viewbox="0 -691.8 947.3 885.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389 373 390 377 395T388 406 404 418Q438 442 450 442 454 442 457 439T460 434Q460 425 391 149 320-135 320-139 320-147 365-148H390Q396-156 396-157T393-175Q389-188 383-194H370Q339-192 262-192 234-192 211-192T174-192 157-193Q143-193 143-185 143-182 145-170 149-154 152-151T172-148Q220-148 230-141 238-136 258-53T279 32Q279 33 272 29 224-10 172-10 117-10 75 30T33 157ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mo" transform="translate(543.7,363) scale(0.707)"><path data-c="2217" d="M229 286Q216 420 216 436 216 454 240 464 241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315 420 312 357 282T289 250L355 219 425 184Q434 175 434 161 434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63 283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127 106 124 100 124 87 124 76 134T64 161Q64 166 64 169T67 175 72 181 81 188 94 195 113 204 138 215 170 230 210 250L74 315Q65 324 65 338 65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"/></g></g></g></g></svg></mjx-container></span>和模型后验<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="2.076ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 917.6 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>之间的差异。由于<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="2.143ex" height="2.004ex" role="img" focusable="false" viewbox="0 -691.8 947.3 885.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389 373 390 377 395T388 406 404 418Q438 442 450 442 454 442 457 439T460 434Q460 425 391 149 320-135 320-139 320-147 365-148H390Q396-156 396-157T393-175Q389-188 383-194H370Q339-192 262-192 234-192 211-192T174-192 157-193Q143-193 143-185 143-182 145-170 149-154 152-151T172-148Q220-148 230-141 238-136 258-53T279 32Q279 33 272 29 224-10 172-10 117-10 75 30T33 157ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mo" transform="translate(543.7,363) scale(0.707)"><path data-c="2217" d="M229 286Q216 420 216 436 216 454 240 464 241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315 420 312 357 282T289 250L355 219 425 184Q434 175 434 161 434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63 283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127 106 124 100 124 87 124 76 134T64 161Q64 166 64 169T67 175 72 181 81 188 94 195 113 204 138 215 170 230 210 250L74 315Q65 324 65 338 65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"/></g></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="2.076ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 917.6 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>均为高斯分布，KL散度可以通过均值和协方差直接计算。</p><p>为了简化训练过程，通常采用以下策略：</p><ol type="1"><li><strong>噪声预测网络</strong>：通过重参数化，将<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="2.302ex" height="1.489ex" role="img" focusable="false" viewbox="0 -442 1017.6 658"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g><g data-mml-node="mi" transform="translate(636,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>表示为一个噪声预测网络<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="1.857ex" height="1.33ex" role="img" focusable="false" viewbox="0 -431 820.6 588.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>，模型的训练目标转化为最小化预测噪声与真实噪声之间的均方误差：</li></ol><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.791ex" xmlns="http://www.w3.org/2000/svg" width="29.188ex" height="2.791ex" role="img" focusable="false" viewbox="0 -883.9 12901.3 1233.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="4C" d="M62-22T47-22 32-11Q32-1 56 24T83 55Q113 96 138 172T180 320 234 473 323 609Q364 649 419 677T531 705Q559 705 578 696T604 671 615 645 618 623V611Q618 582 615 571T598 548Q581 531 558 520T518 509Q503 509 503 520 503 523 505 536T507 560Q507 590 494 610T452 630Q423 630 410 617 367 578 333 492T271 301 233 170Q211 123 204 112L198 103 224 102Q281 102 369 79T509 52H523Q535 64 544 87T579 128Q616 152 641 152 656 152 656 142 656 101 588 40T433-22Q381-22 289 1T156 28L141 29 131 20Q111 0 87-11Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(723,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401 98 382 98 349 97 344 98 336T114 312 157 287Q175 282 201 278T245 269 277 256Q294 248 310 236T342 195 359 133Q359 71 321 31T198-10H190Q138-10 94 26L86 19 77 10Q71 4 65-1L54-11H46 42Q39-11 33-5V74 132Q33 153 35 157T45 162H54Q66 162 70 158T75 146 82 119 101 77Q136 26 198 26 295 26 295 104 295 133 277 151 257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424 143 442 187 447H198Q238 447 268 432L283 424 292 431Q302 440 314 448H322 326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3 132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49 100 53 102 60T104 102V205 293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441 182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(394,0)"/><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122 103 161 103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441 178 442H181V402Q181 364 182 364T187 369 199 384 218 402 247 421 285 437Q305 442 336 442 351 442 364 440T387 434 406 426 421 417 432 406 441 395 448 384 452 374 455 366L457 361 460 365Q463 369 466 373T475 384 488 397 503 410 523 422 546 432 572 439 603 442Q729 442 740 329 741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62 657 64 657 200 656 335 655 343 649 371 635 385T611 402 585 404Q540 404 506 370 479 343 472 315T464 232V168 108Q464 78 465 68T468 55 477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62 380 64 380 200 379 335 378 343 372 371 358 385T334 402 308 404Q263 404 229 370 202 343 195 315T187 232V168 108Q187 78 188 68T191 55 200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(672,0)"/><path data-c="70" d="M36-148H50Q89-148 97-134V-126Q97-119 97-107T97-77 98-38 98 6 98 55 98 106Q98 140 98 177T98 243 98 296 97 335 97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441 176 442H179V416L180 390 188 397Q247 441 326 441 407 441 464 377T522 216Q522 115 457 52T310-11Q242-11 190 33L182 40V-45-101Q182-128 184-134T195-145Q216-148 244-148H260V-194H252L228-193Q205-192 178-192T140-191Q37-191 28-194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26 345 26 384 80T424 218Z" transform="translate(1505,0)"/><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z" transform="translate(2061,0)"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(2339,0)"/></g></g></g><g data-mml-node="mo" transform="translate(2740.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3129.9,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g><g data-mml-node="mo" transform="translate(3598.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4265.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(5321.4,0)"><g data-mml-node="mi"><path data-c="1D53C" d="M12 666Q12 675 24 683H582Q590 680 593 672V588Q593 514 591 502T575 490Q567 490 563 495T555 517Q552 556 517 590 486 623 445 634T340 648H282Q266 636 264 620T260 492V370H277Q329 375 358 391T404 439Q420 480 420 506 420 529 436 529 445 529 451 521 455 517 455 361 455 333 455 298T456 253Q456 217 453 207T437 197Q420 196 420 217 420 240 406 270 377 328 284 335H260V201Q261 174 261 134 262 73 264 61T278 38Q281 36 282 35H331Q400 35 449 50 571 93 602 179 605 203 622 203 629 203 634 197T640 183Q638 181 624 95T604 3L600-1H24Q12 5 12 16 12 35 51 35 92 38 97 52 102 60 102 341T97 632Q91 645 51 648 12 648 12 666ZM137 341Q137 131 136 89T130 37Q129 36 129 35H235Q233 41 231 48L226 61V623L231 635 235 648H129Q132 641 133 638T135 603 137 517 137 341ZM557 603V648H504Q504 646 515 639 527 634 542 619L557 603ZM420 317V397L406 383Q394 370 380 363L366 355Q373 350 382 346 400 333 409 328L420 317ZM582 61 586 88Q585 88 582 83 557 61 526 46L511 37 542 35H577Q577 36 578 39T580 49 582 61Z"/></g></g><g data-mml-node="mrow" transform="translate(6155.1,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="5B" d="M202-349V850H394V810H242V-309H394V-349H202Z"/></g><g data-mml-node="mo" transform="translate(417,0)"><path data-c="2225" d="M133 736Q138 750 153 750 164 750 170 739 172 735 172 250T170-239Q164-250 152-250 144-250 138-244L137-243Q133-241 133-179T132 250Q132 731 133 736ZM329 739Q334 750 346 750 353 750 361 744L362 743Q366 741 366 679T367 250 367-178 362-243L361-244Q355-250 347-250 335-250 329-239 327-235 327 250T329 739Z"/></g><g data-mml-node="msub" transform="translate(917,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(1737.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(2126.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(3036.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3648.1,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(4648.3,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="msup" transform="translate(5392.6,0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750 164 750 170 739 172 735 172 250T170-239Q164-250 152-250 144-250 138-244L137-243Q133-241 133-179T132 250Q132 731 133 736ZM329 739Q334 750 346 750 353 750 361 744L362 743Q366 741 366 679T367 250 367-178 362-243L361-244Q355-250 347-250 335-250 329-239 327-235 327 250T329 739Z"/></g><g data-mml-node="mn" transform="translate(533,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g><g data-mml-node="mo" transform="translate(6329.2,0) translate(0 -0.5)"><path data-c="5D" d="M22 810V850H214V-349H22V-309H174V810H22Z"/></g></g></g></g></svg></mjx-container></span></p><ol start="2" type="1"><li><strong>协方差矩阵的学习</strong>：为了进一步提高模型性能，需要学习逆向过程的协方差矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="2.572ex" height="1.901ex" role="img" focusable="false" viewbox="0 -683 1136.6 840.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299 56 644 55 658Q55 677 60 681 63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294 189L293 494Q314 465 345 422 400 346 400 340 400 338 399 337L154 57Q407 57 428 58 476 60 508 68T551 83 575 103Q595 125 608 162T624 225L626 251H666V247Z"/></g><g data-mml-node="mi" transform="translate(755,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>。首先用<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.65ex" xmlns="http://www.w3.org/2000/svg" width="6.201ex" height="2.245ex" role="img" focusable="false" viewbox="0 -705 2740.9 992.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="4C" d="M62-22T47-22 32-11Q32-1 56 24T83 55Q113 96 138 172T180 320 234 473 323 609Q364 649 419 677T531 705Q559 705 578 696T604 671 615 645 618 623V611Q618 582 615 571T598 548Q581 531 558 520T518 509Q503 509 503 520 503 523 505 536T507 560Q507 590 494 610T452 630Q423 630 410 617 367 578 333 492T271 301 233 170Q211 123 204 112L198 103 224 102Q281 102 369 79T509 52H523Q535 64 544 87T579 128Q616 152 641 152 656 152 656 142 656 101 588 40T433-22Q381-22 289 1T156 28L141 29 131 20Q111 0 87-11Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(723,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401 98 382 98 349 97 344 98 336T114 312 157 287Q175 282 201 278T245 269 277 256Q294 248 310 236T342 195 359 133Q359 71 321 31T198-10H190Q138-10 94 26L86 19 77 10Q71 4 65-1L54-11H46 42Q39-11 33-5V74 132Q33 153 35 157T45 162H54Q66 162 70 158T75 146 82 119 101 77Q136 26 198 26 295 26 295 104 295 133 277 151 257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424 143 442 187 447H198Q238 447 268 432L283 424 292 431Q302 440 314 448H322 326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3 132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49 100 53 102 60T104 102V205 293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441 182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(394,0)"/><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122 103 161 103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441 178 442H181V402Q181 364 182 364T187 369 199 384 218 402 247 421 285 437Q305 442 336 442 351 442 364 440T387 434 406 426 421 417 432 406 441 395 448 384 452 374 455 366L457 361 460 365Q463 369 466 373T475 384 488 397 503 410 523 422 546 432 572 439 603 442Q729 442 740 329 741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62 657 64 657 200 656 335 655 343 649 371 635 385T611 402 585 404Q540 404 506 370 479 343 472 315T464 232V168 108Q464 78 465 68T468 55 477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62 380 64 380 200 379 335 378 343 372 371 358 385T334 402 308 404Q263 404 229 370 202 343 195 315T187 232V168 108Q187 78 188 68T191 55 200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(672,0)"/><path data-c="70" d="M36-148H50Q89-148 97-134V-126Q97-119 97-107T97-77 98-38 98 6 98 55 98 106Q98 140 98 177T98 243 98 296 97 335 97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441 176 442H179V416L180 390 188 397Q247 441 326 441 407 441 464 377T522 216Q522 115 457 52T310-11Q242-11 190 33L182 40V-45-101Q182-128 184-134T195-145Q216-148 244-148H260V-194H252L228-193Q205-192 178-192T140-191Q37-191 28-194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26 345 26 384 80T424 218Z" transform="translate(1505,0)"/><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z" transform="translate(2061,0)"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(2339,0)"/></g></g></g></g></g></svg></mjx-container></span>训练噪声预测网络<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="1.857ex" height="1.33ex" role="img" focusable="false" viewbox="0 -431 820.6 588.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>，然后固定<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="1.857ex" height="1.33ex" role="img" focusable="false" viewbox="0 -431 820.6 588.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>，并优化整个损失函数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.05ex" xmlns="http://www.w3.org/2000/svg" width="1.561ex" height="1.645ex" role="img" focusable="false" viewbox="0 -705 690 727"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="4C" d="M62-22T47-22 32-11Q32-1 56 24T83 55Q113 96 138 172T180 320 234 473 323 609Q364 649 419 677T531 705Q559 705 578 696T604 671 615 645 618 623V611Q618 582 615 571T598 548Q581 531 558 520T518 509Q503 509 503 520 503 523 505 536T507 560Q507 590 494 610T452 630Q423 630 410 617 367 578 333 492T271 301 233 170Q211 123 204 112L198 103 224 102Q281 102 369 79T509 52H523Q535 64 544 87T579 128Q616 152 641 152 656 152 656 142 656 101 588 40T433-22Q381-22 289 1T156 28L141 29 131 20Q111 0 87-11Z"/></g></g></g></g></svg></mjx-container></span>来训练协方差矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="2.572ex" height="1.901ex" role="img" focusable="false" viewbox="0 -683 1136.6 840.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299 56 644 55 658Q55 677 60 681 63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294 189L293 494Q314 465 345 422 400 346 400 340 400 338 399 337L154 57Q407 57 428 58 476 60 508 68T551 83 575 103Q595 125 608 162T624 225L626 251H666V247Z"/></g><g data-mml-node="mi" transform="translate(755,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>。</li></ol><h4><span id="4-tu-xiang-sheng-cheng">4. 图像生成</span><a href="#4-tu-xiang-sheng-cheng" class="header-anchor"></a></h4><p>训练完成后，生成新图像的过程如下：</p><ol type="1"><li><strong>初始化</strong>：从标准正态分布中采样一个初始噪声<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="12.724ex" height="2.351ex" role="img" focusable="false" viewbox="0 -789 5624 1039"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445 21 450 37 501T71 602L88 651Q93 669 101 677H569 659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437 640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631 469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46 418 46 427 45T436 36Q436 31 433 22 429 4 424 1L422 0Q419 0 415 0 410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83 94Q174 46 189 55 190 56 191 56 196 59 201 76T241 233Q258 301 269 344 339 619 339 625 339 630 310 630H279Q212 630 191 624 146 614 121 583T67 467Q60 445 57 441T43 437H40Z"/></g></g></g><g data-mml-node="mo" transform="translate(1430.6,0)"><path data-c="223C" d="M55 166Q55 241 101 304T222 367Q260 367 296 349T362 304 421 252 484 208 554 189Q616 189 655 236T694 338Q694 350 698 358T708 367Q722 367 722 334 722 260 677 197T562 134H554Q517 134 481 152T414 196 355 248 292 293 223 311Q179 311 145 286 109 257 96 218T80 156 69 133Q55 133 55 166Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2486.4,0)"><g data-mml-node="mi"><path data-c="4E" d="M343 705Q358 705 358 698 360 696 370 658T411 524 484 319Q536 174 590 82L595 73 615 152Q646 274 683 407 729 571 752 637T799 727Q852 780 937 788 939 788 947 788T958 789H962Q979 789 979 765 979 722 951 692 942 683 924 683 888 681 859 672T818 654 803 639Q784 608 708 322T631 15Q631 14 630 15 630 17 629 15 628 14 628 12 621-4 601-17T560-31Q550-31 546-28T530-7Q484 67 458 123T398 272Q352 392 314 514L306 535V534Q306 533 296 488T272 379 234 239 185 100 127-7 61-50Q34-50 4-34T-27 8Q-27 33-12 61T18 90Q21 90 36 77T87 57H92Q109 57 123 78T162 173Q206 299 232 417T265 599 276 667Q284 681 304 693T343 705Z"/></g></g><g data-mml-node="mo" transform="translate(3465.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mn" transform="translate(3854.4,0)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g><g data-mml-node="mo" transform="translate(4354.4,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4799,0)"><g data-mml-node="mi"><path data-c="1D408" d="M397 0Q370 3 218 3 65 3 38 0H25V62H139V624H25V686H38Q65 683 218 683 370 683 397 686H410V624H296V62H410V0H397Z"/></g></g><g data-mml-node="mo" transform="translate(5235,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>。</li><li><strong>迭代去噪</strong>：通过逆向扩散过程，逐步采样<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="17.75ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 7845.4 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(2091.7,0)"><path data-c="223C" d="M55 166Q55 241 101 304T222 367Q260 367 296 349T362 304 421 252 484 208 554 189Q616 189 655 236T694 338Q694 350 698 358T708 367Q722 367 722 334 722 260 677 197T562 134H554Q517 134 481 152T414 196 355 248 292 293 223 311Q179 311 145 286 109 257 96 218T80 156 69 133Q55 133 55 166Z"/></g><g data-mml-node="msub" transform="translate(3147.5,0)"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(4065.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(4454.1,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(6268.1,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(6546.1,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(7456.4,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>直到生成最终的图像<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.375ex" xmlns="http://www.w3.org/2000/svg" width="2.282ex" height="1.375ex" role="img" focusable="false" viewbox="0 -442 1008.6 607.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></g></svg></mjx-container></span>。</li></ol><h3><span id="classifier-free-guidance">Classifier-free guidance</span><a href="#classifier-free-guidance" class="header-anchor"></a></h3><p><strong>无分类器引导（Classifier-free Guidance）</strong></p><p>条件扩散模型在生成过程中会接收额外的信息作为输入，例如类别标签<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>。在这种情况下，反向过程表示为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="12.614ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 5575.5 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(917.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1306.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(361,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1139,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(3120.6,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="msub" transform="translate(3398.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(4308.8,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(4753.5,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(5186.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>，其中噪声预测网络<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="1.857ex" height="1.33ex" role="img" focusable="false" viewbox="0 -431 820.6 588.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>和协方差矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.355ex" xmlns="http://www.w3.org/2000/svg" width="2.572ex" height="1.901ex" role="img" focusable="false" viewbox="0 -683 1136.6 840.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299 56 644 55 658Q55 677 60 681 63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294 189L293 494Q314 465 345 422 400 346 400 340 400 338 399 337L154 57Q407 57 428 58 476 60 508 68T551 83 575 103Q595 125 608 162T624 225L626 251H666V247Z"/></g><g data-mml-node="mi" transform="translate(755,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g></g></g></svg></mjx-container></span>都是基于条件<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>进行调整的。在此框架下，<strong>无分类器引导</strong>方法被用于引导采样过程，使得生成的样本<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 572 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g></g></svg></mjx-container></span>满足<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="9.069ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 4008.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(1278,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(1444.7,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(1947.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2336.7,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2769.7,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(3047.7,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3619.7,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>较高。</p><p>根据贝叶斯定理，我们有：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="31.382ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 13871 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(1278,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(1444.7,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(1947.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2336.7,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2769.7,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(3047.7,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3619.7,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4286.4,0)"><path data-c="221D" d="M56 124T56 216 107 375 238 442Q260 442 280 438T319 425 352 407 382 385 406 361 427 336 442 315 455 297 462 285L469 297Q555 442 679 442 687 442 722 437V398H718Q710 400 694 400 657 400 623 383T567 343 527 294 503 253 495 235Q495 231 520 192T554 143Q625 44 696 44 717 44 719 46H722V-5Q695-11 678-11 552-11 457 141 455 145 454 146L447 134Q362-11 235-11 157-11 107 56ZM93 213Q93 143 126 87T220 31Q258 31 292 48T349 88 389 137 413 178 421 196Q421 200 396 239T362 288Q322 345 288 366T213 387Q163 387 128 337T93 213Z"/></g><g data-mml-node="mi" transform="translate(5342.2,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(6620.2,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(6786.9,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(7289.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(7678.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(8250.9,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(8528.9,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(8961.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(9573.1,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(10573.3,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(11851.3,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(12018,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(12521,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(12910,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(13482,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>因此，其梯度可以表示为：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="41.476ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 18332.4 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="2207" d="M46 676Q46 679 51 683H781Q786 679 786 676 786 674 617 326T444-26Q439-33 416-33T388-26Q385-22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"/></g><g data-mml-node="mi" transform="translate(866,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g><g data-mml-node="mi" transform="translate(1487.1,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(2765.1,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(2931.8,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(3434.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3823.8,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(4256.8,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(4534.8,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(5106.8,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(5773.6,0)"><path data-c="221D" d="M56 124T56 216 107 375 238 442Q260 442 280 438T319 425 352 407 382 385 406 361 427 336 442 315 455 297 462 285L469 297Q555 442 679 442 687 442 722 437V398H718Q710 400 694 400 657 400 623 383T567 343 527 294 503 253 495 235Q495 231 520 192T554 143Q625 44 696 44 717 44 719 46H722V-5Q695-11 678-11 552-11 457 141 455 145 454 146L447 134Q362-11 235-11 157-11 107 56ZM93 213Q93 143 126 87T220 31Q258 31 292 48T349 88 389 137 413 178 421 196Q421 200 396 239T362 288Q322 345 288 366T213 387Q163 387 128 337T93 213Z"/></g><g data-mml-node="msub" transform="translate(6829.4,0)"><g data-mml-node="mi"><path data-c="2207" d="M46 676Q46 679 51 683H781Q786 679 786 676 786 674 617 326T444-26Q439-33 416-33T388-26Q385-22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"/></g><g data-mml-node="mi" transform="translate(866,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g><g data-mml-node="mi" transform="translate(8316.5,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(9594.5,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(9761.2,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(10264.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(10653.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(11225.2,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(11503.2,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(11936.2,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(12547.4,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(13547.6,0)"><g data-mml-node="mi"><path data-c="2207" d="M46 676Q46 679 51 683H781Q786 679 786 676 786 674 617 326T444-26Q439-33 416-33T388-26Q385-22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"/></g><g data-mml-node="mi" transform="translate(866,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g><g data-mml-node="mi" transform="translate(15034.7,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(16312.7,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(16479.4,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(16982.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(17371.4,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(17943.4,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>在扩散模型中，输出可以被解释为得分函数（score function），因此可以通过以下方式引导DDPM采样过程，使得生成的样本<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 572 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g></g></svg></mjx-container></span>具有较高的条件概率<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="5.801ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 2564 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(503,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(1464,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(1742,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2175,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="72.681ex" height="2.398ex" role="img" focusable="false" viewbox="0 -810 32125 1060"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mo" transform="translate(258.6,16) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(820.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1209.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(2119.9,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(2564.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2997.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3664.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(4720.1,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(5540.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(5929.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(6840,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(7284.7,0)"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g><g data-mml-node="mo" transform="translate(7784.7,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(8395.9,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(9396.1,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415 300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372 367 378Q368 378 368 379 368 382 361 388T336 399 297 405Q249 405 227 379T204 326Q204 301 223 291T278 274 330 259Q396 230 396 163 396 135 385 107T352 51 289 7 195-10Q118-10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34 201 27Q237 27 263 38T301 66 318 97 323 122Q323 150 302 164T254 181 195 196 148 231Q131 256 131 289Z"/></g><g data-mml-node="mo" transform="translate(10087.4,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="msub" transform="translate(10587.6,0)"><g data-mml-node="mi"><path data-c="2207" d="M46 676Q46 679 51 683H781Q786 679 786 676 786 674 617 326T444-26Q439-33 416-33T388-26Q385-22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z"/></g><g data-mml-node="mi" transform="translate(866,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g><g data-mml-node="mi" transform="translate(12074.7,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(278,0)"/><path data-c="67" d="M329 409Q373 453 429 453 459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390 410 404 415 411 415 412 416 414V415Q388 412 363 393 355 388 355 386 355 385 359 381T368 369 379 351 388 325 392 292Q392 230 343 187T222 143Q172 143 123 171 112 153 112 133 112 98 138 81 147 75 155 75T227 73Q311 72 335 67 396 58 431 26 470-13 470-72 470-139 392-175 332-206 250-206 167-206 107-175 29-140 29-75 29-39 50-15T92 18L103 24Q67 55 67 108 67 155 96 193 52 237 52 292 52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292 142 248 149 227T179 192Q196 182 222 182 244 182 260 189T283 207 294 227 299 242Q302 258 302 292T299 343ZM403-75Q403-50 389-34T348-11 299-2 245 0H218Q151 0 138-6 118-15 107-34T95-74Q95-84 101-97T122-127 170-155 250-167Q319-167 361-139T403-75Z" transform="translate(778,0)"/></g><g data-mml-node="mo" transform="translate(13352.7,0)"><path data-c="2061" d=""/></g><g data-mml-node="mi" transform="translate(13519.4,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(14022.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(14411.4,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(14983.4,0) translate(0 -0.5)"><path data-c="7C" d="M139-249H137Q125-249 119-235V251L120 737Q130 750 139 750 152 750 159 735V-235Q151-249 141-249H139Z"/></g><g data-mml-node="mi" transform="translate(15261.4,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(15694.4,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(16361.2,0)"><path data-c="221D" d="M56 124T56 216 107 375 238 442Q260 442 280 438T319 425 352 407 382 385 406 361 427 336 442 315 455 297 462 285L469 297Q555 442 679 442 687 442 722 437V398H718Q710 400 694 400 657 400 623 383T567 343 527 294 503 253 495 235Q495 231 520 192T554 143Q625 44 696 44 717 44 719 46H722V-5Q695-11 678-11 552-11 457 141 455 145 454 146L447 134Q362-11 235-11 157-11 107 56ZM93 213Q93 143 126 87T220 31Q258 31 292 48T349 88 389 137 413 178 421 196Q421 200 396 239T362 288Q322 345 288 366T213 387Q163 387 128 337T93 213Z"/></g><g data-mml-node="msub" transform="translate(17416.9,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(18237.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(18626.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(19536.8,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(19981.5,0)"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g><g data-mml-node="mo" transform="translate(20481.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(21092.7,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(22092.9,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415 300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372 367 378Q368 378 368 379 368 382 361 388T336 399 297 405Q249 405 227 379T204 326Q204 301 223 291T278 274 330 259Q396 230 396 163 396 135 385 107T352 51 289 7 195-10Q118-10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34 201 27Q237 27 263 38T301 66 318 97 323 122Q323 150 302 164T254 181 195 196 148 231Q131 256 131 289Z"/></g><g data-mml-node="mo" transform="translate(22784.2,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="mo" transform="translate(23284.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(23673.4,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(24494,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(24883,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(25793.3,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(26237.9,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(26670.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(27282.2,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(28282.4,0)"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(29103,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(29492,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(30402.3,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(30847,0)"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g><g data-mml-node="mo" transform="translate(31347,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(31736,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.09ex" xmlns="http://www.w3.org/2000/svg" width="5.209ex" height="1.597ex" role="img" focusable="false" viewbox="0 -666 2302.6 706"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415 300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372 367 378Q368 378 368 379 368 382 361 388T336 399 297 405Q249 405 227 379T204 326Q204 301 223 291T278 274 330 259Q396 230 396 163 396 135 385 107T352 51 289 7 195-10Q118-10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34 201 27Q237 27 263 38T301 66 318 97 323 122Q323 150 302 164T254 181 195 196 148 231Q131 256 131 289Z"/></g><g data-mml-node="mo" transform="translate(746.8,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107-40H101Q83-38 83-20 83-19 83-17 82-10 98-1 117 9 248 71 326 108 378 132L626 250 378 368Q90 504 86 509 84 513 84 520Z"/></g><g data-mml-node="mn" transform="translate(1802.6,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g></svg></mjx-container></span>表示引导的尺度（注意，当<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="5.209ex" height="1.692ex" role="img" focusable="false" viewbox="0 -666 2302.6 748"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415 300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372 367 378Q368 378 368 379 368 382 361 388T336 399 297 405Q249 405 227 379T204 326Q204 301 223 291T278 274 330 259Q396 230 396 163 396 135 385 107T352 51 289 7 195-10Q118-10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34 201 27Q237 27 263 38T301 66 318 97 323 122Q323 150 302 164T254 181 195 196 148 231Q131 256 131 289Z"/></g><g data-mml-node="mo" transform="translate(746.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1802.6,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g></g></svg></mjx-container></span>时，恢复为标准采样）。具体来说：</p><ol type="1"><li><p><strong>条件与无条件预测</strong>：模型同时训练有条件（带标签<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>）和无条件（不带标签，使用一个学习到的“空”嵌入<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.176ex" xmlns="http://www.w3.org/2000/svg" width="1.131ex" height="1.923ex" role="img" focusable="false" viewbox="0 -772 500 850"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g></g></g></svg></mjx-container></span>）的噪声预测<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="7.662ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3386.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(820.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1209.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(2119.9,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(2564.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2997.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="7.813ex" height="2.312ex" role="img" focusable="false" viewbox="0 -772 3453.6 1022"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g><g data-mml-node="mi" transform="translate(439,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610 319 704Q320 704 327 704T339 705Q393 701 423 656 462 596 462 495 462 380 417 261T302 66 168-10H161Q125-10 99 10T60 63 41 130 35 200ZM383 566Q383 668 330 668 294 668 260 623T204 521 170 421 157 371Q206 370 254 370L351 371Q352 372 359 404T375 484 383 566ZM113 132Q113 26 166 26 181 26 198 36T239 74 287 161 335 307L340 324H145Q145 321 136 286T120 208 113 132Z"/></g></g><g data-mml-node="mo" transform="translate(820.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(1209.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(2119.9,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(2564.6,0)"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g><g data-mml-node="mo" transform="translate(3064.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>。</p></li><li><p><strong>引导采样</strong>：在采样过程中，通过结合有条件预测与无条件预测的差异，并乘以引导尺度<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.023ex" role="img" focusable="false" viewbox="0 -442 469 452"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415 300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372 367 378Q368 378 368 379 368 382 361 388T336 399 297 405Q249 405 227 379T204 326Q204 301 223 291T278 274 330 259Q396 230 396 163 396 135 385 107T352 51 289 7 195-10Q118-10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34 201 27Q237 27 263 38T301 66 318 97 323 122Q323 150 302 164T254 181 195 196 148 231Q131 256 131 289Z"/></g></g></g></svg></mjx-container></span>，调整噪声预测，从而增强生成样本对条件<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>的符合度。</p></li><li><p><strong>随机丢弃条件信息</strong>：在训练阶段，通过随机丢弃条件<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>并用“空”嵌入<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.176ex" xmlns="http://www.w3.org/2000/svg" width="1.131ex" height="1.923ex" role="img" focusable="false" viewbox="0 -772 500 850"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="2205" d="M331 696Q335 708 339 722T345 744 350 759 357 769 367 772Q374 772 381 767T388 754Q388 746 377 712L366 673 378 661Q460 575 460 344 460 281 456 234T432 126 373 27Q319-22 250-22 214-22 180-7 168-3 168-4L159-33Q148-71 142-75 138-78 132-78 124-78 118-72T111-60Q111-52 122-18L133 21 125 29Q39 111 39 344 39 596 137 675 187 716 251 716 265 716 278 714T296 710 315 703 331 696ZM276 676Q264 679 246 679 196 679 159 631 134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16 291 16 324 47 354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"/></g></g></g></svg></mjx-container></span>替代，使模型能够同时处理有条件和无条件的情况。</p></li></ol><p>无分类器引导通过在模型内部同时处理有条件和无条件的信息，并在采样过程中动态调整生成过程，从而无需额外的分类器即可有效引导生成样本，更加简便且效果显著。</p><h3><span id="latent-diffusion-models">Latent diffusion models</span><a href="#latent-diffusion-models" class="header-anchor"></a></h3><p><strong>潜在扩散模型（Latent Diffusion Models）</strong></p><p>直接在高分辨率像素空间中训练扩散模型，往往会面临计算资源消耗巨大的问题。<strong>Latent Diffusion Model(LDMs)</strong>针对这一挑战提出了一种两阶段的方法：</p><ol type="1"><li><p><strong>学习自动编码器（Autoencoder）</strong>：首先，训练一个自动编码器，将高分辨率的图像压缩为较小的空间表示。自动编码器包括一个编码器<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.729ex" height="1.538ex" role="img" focusable="false" viewbox="0 -680 764 680"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g></g></g></svg></mjx-container></span>，用于将图像<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 572 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g></g></svg></mjx-container></span>转换为潜在表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="8.852ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3912.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g><g data-mml-node="mo" transform="translate(742.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1798.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(2562.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2951.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3523.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>，以及一个解码器<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.873ex" height="1.545ex" role="img" focusable="false" viewbox="0 -683 828 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637 207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683 570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1 236 0H125 72Q48 0 41 2T33 11Q33 13 36 25 40 41 44 43T67 46Q94 46 127 49 141 52 146 61 149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584 629 613 590 629 555 636Q553 636 541 636T512 636 479 637H436Q392 637 386 627 384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128 617 164 640 212T683 339 703 469Z"/></g></g></g></svg></mjx-container></span>，用于将潜在表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>还原为图像<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="8.997ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3976.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(849.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1905.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637 207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683 570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1 236 0H125 72Q48 0 41 2T33 11Q33 13 36 25 40 41 44 43T67 46Q94 46 127 49 141 52 146 61 149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584 629 613 590 629 555 636Q553 636 541 636T512 636 479 637H436Q392 637 386 627 384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128 617 164 640 212T683 339 703 469Z"/></g><g data-mml-node="mo" transform="translate(2733.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3122.6,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g><g data-mml-node="mo" transform="translate(3587.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>。在这一过程中，编码器和解码器的参数通过训练学习得到，确保可以有效地压缩和重构图像。</p></li><li><p><strong>训练潜在空间中的扩散模型</strong>：在第二阶段，不再直接在原始像素空间中的图像<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 572 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g></g></svg></mjx-container></span>上训练扩散模型，而是在自动编码器生成的潜在表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="8.852ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3912.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g><g data-mml-node="mo" transform="translate(742.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1798.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(2562.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2951.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3523.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>上进行训练。具体来说，冻结编码器<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.729ex" height="1.538ex" role="img" focusable="false" viewbox="0 -680 764 680"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g></g></g></svg></mjx-container></span>，仅训练扩散模型来生成潜在表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>。</p></li></ol><p>通过这种两阶段的方法，LDMs 能够显著减少计算需求，因为在潜在空间中的表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>通常比原始高分辨率图像<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 572 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g></g></g></svg></mjx-container></span>小得多，从而大幅降低了计算量。</p><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409222019053.png" alt="image-20240922201900742"></p><p>如图所示，LDMs 在保持良好生成性能的同时，大幅降低了计算复杂度。这使得LDMs成为进行架构探索的理想起点，特别是在关注计算效率的情况下。在本文中，作者将<strong>DiTs（Diffusion Transformers）</strong> 应用于潜在空间。这种方法使得本文的图像生成pipeline成为一种混合方法：先使用现成的卷积变分自编码器（Convolutional VAEs）进行潜在空间的编码与解码，然后结合基于Transformer的去噪扩散概率模型。</p><h2><span id="diffusion-transformer-design-space">Diffusion Transformer Design Space</span><a href="#diffusion-transformer-design-space" class="header-anchor"></a></h2><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409222021070.png" alt="image-20240922202143793"></p><h3><span id="patchify">Patchify</span><a href="#patchify" class="header-anchor"></a></h3><p>在<strong>DiT（Diffusion Transformer）</strong>模型中，<strong>Patchify</strong> 是其第一层关键组件，用于将输入的空间表示转换为适合Transformer处理的序列形式。</p><ol type="1"><li><p><strong>输入空间表示</strong></p><p>DiT模型的输入是一个潜在空间表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>。分辨率为256×256×3的图像经过编码器处理后得到的<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>形状为32×32×4。图像将被压缩到一个较低维度的潜在空间中，每个空间位置有4个特征通道。</p></li><li><p><strong>Patchify</strong></p><p>Patchify就是将空间表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>转换为一系列的tokens，以便于Transformer处理。具体步骤如下：</p><ul><li><strong>分块（Patching）</strong>：将输入的空间表示<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>按照预定的块大小<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="5.042ex" height="1.55ex" role="img" focusable="false" viewbox="0 -491 2228.4 685"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(725.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mi" transform="translate(1725.4,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>进行分块。例如，当块大小<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="5.286ex" height="1.971ex" role="img" focusable="false" viewbox="0 -677 2336.6 871"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(780.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1836.6,0)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0H190V46H221Q241 46 248 46T265 48 279 53 286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675 336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212 183 211H293Z"/></g></g></g></svg></mjx-container></span>时，输入的32×32×4的<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>会被分成<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.781ex" xmlns="http://www.w3.org/2000/svg" width="21.281ex" height="2.737ex" role="img" focusable="false" viewbox="0 -864.9 9406.2 1209.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664 351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336 375 315Q457 262 457 175 457 96 395 37T238-22Q158-22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94 148 82 136 74 126 70 118 67L114 66Q165 21 238 21 293 21 321 74 338 107 338 175V195Q338 290 274 322 259 328 213 329L171 330 168 332Q166 335 166 348 166 366 174 366 202 366 232 371 266 376 294 413T322 525V533Q322 590 287 612 265 626 240 626 208 626 181 615T143 592 132 580H135Q138 579 143 578T153 573 165 566 175 555 183 540 186 520Q186 498 172 481T127 463Z"/><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"/></g><g data-mml-node="mn" transform="translate(396.8,-345) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0H190V46H221Q241 46 248 46T265 48 279 53 286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675 336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212 183 211H293Z"/></g><rect width="907.1" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1369.3,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mfrac" transform="translate(2369.6,0)"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664 351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336 375 315Q457 262 457 175 457 96 395 37T238-22Q158-22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94 148 82 136 74 126 70 118 67L114 66Q165 21 238 21 293 21 321 74 338 107 338 175V195Q338 290 274 322 259 328 213 329L171 330 168 332Q166 335 166 348 166 366 174 366 202 366 232 371 266 376 294 413T322 525V533Q322 590 287 612 265 626 240 626 208 626 181 615T143 592 132 580H135Q138 579 143 578T153 573 165 566 175 555 183 540 186 520Q186 498 172 481T127 463Z"/><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"/></g><g data-mml-node="mn" transform="translate(396.8,-345) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0H190V46H221Q241 46 248 46T265 48 279 53 286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675 336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212 183 211H293Z"/></g><rect width="907.1" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(3794.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(4850.2,0)"><path data-c="38" d="M70 417T70 494 124 618 248 666Q319 666 374 624T429 515Q429 485 418 459T392 417 361 389 335 371 324 363L338 354Q352 344 366 334T382 323Q457 264 457 174 457 95 399 37T249-22Q159-22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368 70 417 70 494ZM286 386 292 390Q298 394 301 396T311 403 323 413 334 425 345 438 355 454 364 471 369 491 371 513Q371 556 342 586T275 624Q268 625 242 625 201 625 165 599T128 534Q128 511 141 492T167 463 217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194 353 216 330 234 301 253 274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239 107 157Q107 98 150 60T250 21Z"/></g><g data-mml-node="mo" transform="translate(5572.4,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mn" transform="translate(6572.7,0)"><path data-c="38" d="M70 417T70 494 124 618 248 666Q319 666 374 624T429 515Q429 485 418 459T392 417 361 389 335 371 324 363L338 354Q352 344 366 334T382 323Q457 264 457 174 457 95 399 37T249-22Q159-22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368 70 417 70 494ZM286 386 292 390Q298 394 301 396T311 403 323 413 334 425 345 438 355 454 364 471 369 491 371 513Q371 556 342 586T275 624Q268 625 242 625 201 625 165 599T128 534Q128 511 141 492T167 463 217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194 353 216 330 234 301 253 274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239 107 157Q107 98 150 60T250 21Z"/></g><g data-mml-node="mo" transform="translate(7350.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(8406.2,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601 351 623 311 626 240 626 194 566 147 500 147 364L148 360Q153 366 156 373 197 433 263 433H267Q313 433 348 414 372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149 440 90 387 34T253-22Q225-22 199-14T143 16 92 75 56 172 42 313ZM257 397Q227 397 205 380T171 335 154 278 148 216Q148 133 160 97T198 39Q222 21 251 21 302 21 329 59 342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"/><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0H190V46H221Q241 46 248 46T265 48 279 53 286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675 336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212 183 211H293Z" transform="translate(500,0)"/></g></g></g></svg></mjx-container></span>个块。</li><li><strong>线性嵌入（Linear Embedding）</strong>：每个patch被线性投影到一个固定维度<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewbox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></svg></mjx-container></span>的向量空间，生成一个维度为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewbox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></svg></mjx-container></span>的token。<br>因此，整个输入<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 465 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g></g></g></svg></mjx-container></span>在经过Patchify后会被转换为长度为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.593ex" height="1.532ex" role="img" focusable="false" viewbox="0 -677 704 677"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445 21 450 37 501T71 602L88 651Q93 669 101 677H569 659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437 640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631 469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46 418 46 427 45T436 36Q436 31 433 22 429 4 424 1L422 0Q419 0 415 0 410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83 94Q174 46 189 55 190 56 191 56 196 59 201 76T241 233Q258 301 269 344 339 619 339 625 339 630 310 630H279Q212 630 191 624 146 614 121 583T67 467Q60 445 57 441T43 437H40Z"/></g></g></g></svg></mjx-container></span>的token序列，每个token的维度为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewbox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></svg></mjx-container></span>，其中<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-1.469ex" xmlns="http://www.w3.org/2000/svg" width="27.568ex" height="4.07ex" role="img" focusable="false" viewbox="0 -1149.5 12184.9 1799"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445 21 450 37 501T71 602L88 651Q93 669 101 677H569 659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437 640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631 469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46 418 46 427 45T436 36Q436 31 433 22 429 4 424 1L422 0Q419 0 415 0 410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83 94Q174 46 189 55 190 56 191 56 196 59 201 76T241 233Q258 301 269 344 339 619 339 625 339 630 310 630H279Q212 630 191 624 146 614 121 583T67 467Q60 445 57 441T43 437H40Z"/></g><g data-mml-node="mo" transform="translate(981.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mrow" transform="translate(2037.6,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="28" d="M180 96T180 250 205 541 266 770 353 944 444 1069 527 1150H555Q561 1144 561 1141 561 1137 545 1120T504 1072 447 995 386 878 330 721 288 513 272 251Q272 133 280 56 293-87 326-209T399-405 475-531 536-609 561-640Q561-643 555-649H527Q483-612 443-568T353-443 266-270 205-41Z"/></g><g data-mml-node="mfrac" transform="translate(597,0)"><g data-mml-node="mtext" transform="translate(220,481.4) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">输</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">入</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">宽</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">度</text></g><g data-mml-node="mi" transform="translate(1456.4,-345) scale(0.707)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><rect width="3028.4" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(3865.4,0) translate(0 -0.5)"><path data-c="29" d="M35 1138Q35 1150 51 1150H56 69Q113 1113 153 1069T243 944 330 771 391 541 416 250 391-40 330-270 243-443 152-568 69-649H56Q43-649 39-647T35-637Q65-607 110-548 283-316 316 56 324 133 324 251 324 368 316 445 278 877 48 1123 36 1137 35 1138Z"/></g></g><g data-mml-node="mo" transform="translate(6722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mrow" transform="translate(7722.4,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="28" d="M180 96T180 250 205 541 266 770 353 944 444 1069 527 1150H555Q561 1144 561 1141 561 1137 545 1120T504 1072 447 995 386 878 330 721 288 513 272 251Q272 133 280 56 293-87 326-209T399-405 475-531 536-609 561-640Q561-643 555-649H527Q483-612 443-568T353-443 266-270 205-41Z"/></g><g data-mml-node="mfrac" transform="translate(597,0)"><g data-mml-node="mtext" transform="translate(220,481.4) scale(0.707)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">输</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">入</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">高</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">度</text></g><g data-mml-node="mi" transform="translate(1456.4,-345) scale(0.707)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><rect width="3028.4" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(3865.4,0) translate(0 -0.5)"><path data-c="29" d="M35 1138Q35 1150 51 1150H56 69Q113 1113 153 1069T243 944 330 771 391 541 416 250 391-40 330-270 243-443 152-568 69-649H56Q43-649 39-647T35-637Q65-607 110-548 283-316 316 56 324 133 324 251 324 368 316 445 278 877 48 1123 36 1137 35 1138Z"/></g></g></g></g></svg></mjx-container></span>。</li></ul></li><li><p><strong>位置编码（Positional Embeddings）</strong></p><p>在Patchify之后，对所有生成的token应用标准的ViT中的基于频率的<strong>位置编码</strong>（sine-cosine版本）。位置编码用于保留空间位置信息，使得模型能够理解token之间的相对和绝对位置关系。</p></li><li><p><strong>块大小<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>与计算量的关系</strong></p><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409222046271.png" alt="image-20240922204603154" style="zoom:50%"><br>如图，patch大小<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>是一个超参数，决定了Patchify过程中每个patch的尺寸及生成的token数量<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.593ex" height="1.532ex" role="img" focusable="false" viewbox="0 -677 704 677"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445 21 450 37 501T71 602L88 651Q93 669 101 677H569 659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437 640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631 469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46 418 46 427 45T436 36Q436 31 433 22 429 4 424 1L422 0Q419 0 415 0 410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83 94Q174 46 189 55 190 56 191 56 196 59 201 76T241 233Q258 301 269 344 339 619 339 625 339 630 310 630H279Q212 630 191 624 146 614 121 583T67 467Q60 445 57 441T43 437H40Z"/></g></g></g></svg></mjx-container></span>。token数量<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.593ex" height="1.532ex" role="img" focusable="false" viewbox="0 -677 704 677"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445 21 450 37 501T71 602L88 651Q93 669 101 677H569 659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437 640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631 469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46 418 46 427 45T436 36Q436 31 433 22 429 4 424 1L422 0Q419 0 415 0 410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83 94Q174 46 189 55 190 56 191 56 196 59 201 76T241 233Q258 301 269 344 339 619 339 625 339 630 310 630H279Q212 630 191 624 146 614 121 583T67 467Q60 445 57 441T43 437H40Z"/></g></g></g></svg></mjx-container></span>的增加会显著增加Transformer的计算量（以Gflops计)。因为Transformer的计算复杂度与token数量的平方成正比，减半<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>将导致至少四倍的Gflops增加。然而，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>的变化并不会显著影响模型的参数数量，因为参数数量主要取决于Transformer的架构和每个令牌的维度<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewbox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></svg></mjx-container></span>。</p></li></ol><h3><span id="dit-block-design">DiT block design</span><a href="#dit-block-design" class="header-anchor"></a></h3><p>Patchify之后，输入tokens由一系列transformer blocks处理。除了噪声图像之外，扩散模型有时还会处理附加的条件信息，比如加噪步长t，类标签c，自然语言等。本文探索了4中不同方式处理条件输入的transformer块。</p><ul><li><em>In-context conditioning</em>：这个方法简单地将t和c地向量嵌入作为输入序列中地两个附加tokens，与图像tokens没有区别，类似于ViT中的[cls]。最后一个块之后，再将附加tokens从序列中拿出。这样的方法引入了可以忽略不计地新Gflops。</li><li><em>Cross-attention block</em>：这个方法将t和c的embeddings连接成为了一个长度为2的序列，与图像的token序列分开。transformer块会被修改，额外包含一个多头交叉注意力层在多头自注意力块后。多头交叉注意力增加了几乎15%的开销，贡献了最多的Gflops。</li><li><em>Adaptive layer norm (adaLN) block</em>：用adaptive layer norm(adaLN)替换标准的层归一化。作者不是直接学习缩放和平移参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>，而是通过<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewbox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>的embedding向量和对它们进行回归(通过线性层)。addLN增加了最少的Gflops，因此效率最高。</li><li><em>adaLN-Zero block</em>：除了回归<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>and<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>之外，作者还回归了一个新的参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></svg></mjx-container></span>，用于在残差连接之前进行缩放：<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="15.019ex" height="2.497ex" role="img" focusable="false" viewbox="0 -853.7 6638.4 1103.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(917.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(1973.6,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118-162Q120-162 124-164T135-167 147-168Q160-168 171-155T187-126Q197-99 221 27T267 267 289 382V385H242Q195 385 192 387 188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432 298 434 307 482T319 540Q356 705 465 705 502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603 443 622 454 636T478 657L487 662Q471 668 457 668 445 668 434 658T419 630Q412 601 403 552T387 469 380 433Q380 431 435 431 480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282-47 255-132 212-173 175-205 139-205 107-205 81-186T55-132Q55-95 76-78T118-61Q162-61 162-103 162-122 151-136T127-157L118-162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g><g data-mml-node="mo" transform="translate(2999.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3388.1,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350 174 402 244 433 307 442H310Q355 442 388 420T421 355Q421 265 310 237 261 224 176 223 139 223 138 221 138 219 132 186T125 128Q125 81 146 54T209 26 302 45 394 111Q403 121 406 121 410 121 419 112T429 98 420 82 390 55 344 24 281-1 205-11Q126-11 83 42T39 168ZM373 353Q367 405 305 405 272 405 244 391T199 357 170 316 154 280 149 261Q149 260 169 260 282 260 327 284T373 353Z"/></g><g data-mml-node="mo" transform="translate(3854.1,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4520.9,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(5465.7,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,363) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></g></svg></mjx-container></span>。对于<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></svg></mjx-container></span>，作者首先初始化所有MLP的输出为零向量; 这使得所有残差连接先变为恒等映射。与普通的adaLN模块一样，adaLN-Zero向模型添加的Gflops可以忽略不计。</li></ul><p><strong>最后两个方法在附录有详细讲解</strong></p><h3><span id="model-size">Model size</span><a href="#model-size" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231050839.png" alt="image-20240923105009713"></p><ul><li>N个DiT块，每个以<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.023ex" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewbox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></svg></mjx-container></span>​的隐藏维度运算，并配置注意力头，借鉴的ViT做法。</li><li>四个版本：DiT-S, DiT-B, DiT-L and DiT-XL。</li></ul><h3><span id="transformer-decoder">Transformer decoder</span><a href="#transformer-decoder" class="header-anchor"></a></h3><p>在最终的DiT块之后，需要将图像token解码输出为噪声预测和对角协方差预测。这两个输出的形状都等于原始空间的输入。</p><p>使用一个标准线性解码器去实现：作者先使用final layer norm(adaptive if using adaLN)和线性解码器将最终token解码成<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="10.658ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 4710.9 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(725.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mi" transform="translate(1725.4,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(2450.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mn" transform="translate(3450.9,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g><g data-mml-node="mi" transform="translate(3950.9,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641 490 704Q580 704 633 653 642 643 648 636T656 626L657 623Q660 623 684 649 691 655 699 663T715 679 725 690L740 705H746Q760 705 760 698 760 694 728 561 692 422 692 421 690 416 687 415T669 413H653Q647 419 647 422 647 423 648 429T650 449 651 481Q651 552 619 605T510 659Q484 659 454 652T382 628 299 572 226 479Q194 422 175 346T156 222Q156 108 232 58 280 24 350 24 441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248 648 243 647 239 618 132 523 55T319-22Q206-22 128 53T50 252Z"/></g></g></g></svg></mjx-container></span>的tensor，C为输入channels。最终，作者将这些解码过的tokens重排到原始的空间布局去得到预测的噪声和协方差矩阵。</p><h1><span id="experimental-setup">Experimental Setup</span><a href="#experimental-setup" class="header-anchor"></a></h1><p>命名：根据配置和latent patch size<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g></g></g></svg></mjx-container></span>，例如DiT-XL/2表示XLarge配置和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="5.286ex" height="1.946ex" role="img" focusable="false" viewbox="0 -666 2336.6 860"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317 40 348 55 381 75 411 101 433 134 442Q209 442 230 378L240 387Q302 442 358 442 423 442 460 395T497 281Q497 173 421 82T249-10Q227-10 210-4 199 1 187 11T168 28L161 36Q160 35 139-51T118-138Q118-144 126-145T163-148H188Q194-155 194-157T191-175Q188-187 185-190T172-194Q170-194 161-194T127-193 65-192Q-5-192-24-194H-32Q-39-187-39-183-37-156-26-148H-6Q28-147 33-136 36-130 94 103T155 350Q156 355 156 364 156 405 131 405 109 405 94 377T71 316 59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26 282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405 339 405 328 402T306 393 286 380 269 365 254 350 243 336 235 326L232 322Q232 321 229 308T218 264 204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(780.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1836.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></svg></mjx-container></span>。</p><h3><span id="training">Training</span><a href="#training" class="header-anchor"></a></h3><ul><li>在256 × 256 and 512 × 512 image resolution on the ImageNet dataset中训练。</li><li>用0或者ViT的标准权重初始化最终线性层。</li><li>全部用AdamW优化器训练。</li><li>学习率=<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.05ex" xmlns="http://www.w3.org/2000/svg" width="8.392ex" height="2.022ex" role="img" focusable="false" viewbox="0 -871.8 3709.1 893.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9 604 9 587 25T493 118L389 222 284 117Q178 13 175 11 171 9 168 9 160 9 154 15T147 29Q147 36 161 51T255 146L359 250 255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489 178 487 284 383L389 278 493 382Q570 459 587 475T609 491Q630 491 630 471 630 464 620 453T522 355L418 250 522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="msup" transform="translate(1722.4,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"/></g><g data-mml-node="TeXAtom" transform="translate(1033,393.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="34" d="M462 0Q444 3 333 3 217 3 199 0H190V46H221Q241 46 248 46T265 48 279 53 286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675 336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212 183 211H293Z"/></g></g></g></g></g></svg></mjx-container></span>，无权重衰减，batch size=256。</li><li>水平翻转数据增强。</li><li>没有进行学习率warmup或者正则化。</li><li>保留exponential moving average (EMA)，weights over training with a decay of 0.9999。</li><li>所有报告结果使用EMA模型，所有不同尺寸DiT模型用相同超参数，训练超参数几乎保留于ADM。</li></ul><h3><span id="diffusion">Diffusion</span><a href="#diffusion" class="header-anchor"></a></h3><ul><li>使用Stable Diffusion现成的预训练变分自编码器(VAE)。</li><li>VAE的下采样因子为8，给一个256 × 256 × 3的RGB图像，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="8.852ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3912.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g><g data-mml-node="mo" transform="translate(742.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1798.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(2562.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2951.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3523.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>的shape为32 × 32 × 4。</li><li>从扩散模型采样新的潜在样本后，再利用VAE将<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="8.997ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 3976.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(849.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1905.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637 207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683 570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1 236 0H125 72Q48 0 41 2T33 11Q33 13 36 25 40 41 44 43T67 46Q94 46 127 49 141 52 146 61 149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584 629 613 590 629 555 636Q553 636 541 636T512 636 479 637H436Q392 637 386 627 384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128 617 164 640 212T683 339 703 469Z"/></g><g data-mml-node="mo" transform="translate(2733.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3122.6,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346 162 335 155 324L153 320Q150 317 138 317 117 317 117 325 117 330 120 339 133 378 163 406T229 440Q241 442 246 442 271 442 291 425T329 392 367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434 468 430 463 420T449 399 432 377 418 358L411 349Q368 298 275 214T160 106L148 94 163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143 443 138 442 134 425 72 376 31T278-11Q252-11 232 6T193 40 155 57Q111 57 76-3 70-11 59-11H54 41Q35-5 35-2 35 13 93 84 132 129 225 214T340 322Q352 338 347 338Z"/></g><g data-mml-node="mo" transform="translate(3587.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>将其解码为像素。</li><li>保留ADM的超参数，specifically, we use a tmax = 1000 linear variance schedule ranging from 1×10−4 to 2 × 10−2, ADM’s parameterization of the covariance Σθ and their method for embedding input timesteps and labels.</li></ul><h3><span id="evaluation-metrics">Evaluation metrics</span><a href="#evaluation-metrics" class="header-anchor"></a></h3><ul><li>通过FID来衡量scaling性能，这是一个评估生成模型图像的标准矩阵。</li><li>本文报告 FID-50K using 250 DDPM sampling steps。</li><li>由于FID对小的实现细节很敏感，为保准确，所有报告通过导出样本使用ADM的TensorFlow评估。</li><li>本文报告的FID没有使用classifier-free guidance，额外报告了Inception Score，sFID，Precision/Recall作为附加评估矩阵。</li></ul><h3><span id="compute">Compute</span><a href="#compute" class="header-anchor"></a></h3><ul><li>在JAX上部署了所有模型，利用TPU-v3 pod训练。</li><li>最费算力的DiT-XL/2，以5.7iterations/second的速度在TPU v3-256 pod训练，全局batch size=256。</li></ul><h1><span id="experiments">Experiments</span><a href="#experiments" class="header-anchor"></a></h1><h3><span id="dit-block-design">DiT block design</span><a href="#dit-block-design" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231226676.png" alt="image-20240923122552504"></p><h3><span id="scaling-model-size-and-patch-size">Scaling model size and patch size</span><a href="#scaling-model-size-and-patch-size" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231228433.png" alt="image-20240923122846047"></p><h3><span id="dit-gflops-are-critical-to-improving-performance">DiT Gflops are critical to improving performance</span><a href="#dit-gflops-are-critical-to-improving-performance" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231229278.png" alt="image-20240923122916115"></p><h3><span id="larger-dit-models-are-more-compute-efficient">Larger DiT models are more compute-efficient</span><a href="#larger-dit-models-are-more-compute-efficient" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231229561.png" alt="image-20240923122940103"></p><h3><span id="visualizing-scaling">Visualizing scaling</span><a href="#visualizing-scaling" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231231755.png" alt="image-20240923123107504"></p><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231231195.png" alt="image-20240923123113064"></p><h2><span id="state-of-the-art-diffusion-models">State-of-the-Art Diffusion Models</span><a href="#state-of-the-art-diffusion-models" class="header-anchor"></a></h2><h3><span id="256x256-imagenet">256×256 ImageNet</span><a href="#256x256-imagenet" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231232577.png" alt="image-20240923123240438"></p><h3><span id="512x512-imagenet">512×512 ImageNet</span><a href="#512x512-imagenet" class="header-anchor"></a></h3><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231233513.png" alt="image-20240923123308364"></p><h2><span id="scaling-model-vs-sampling-compute">Scaling Model vs. Sampling Compute</span><a href="#scaling-model-vs-sampling-compute" class="header-anchor"></a></h2><p><img src="https://testingcf.jsdelivr.net/gh/nanzhi84/blog-images/202409231233987.png" alt="image-20240923123344822"></p><h1><span id="conclusion">Conclusion</span><a href="#conclusion" class="header-anchor"></a></h1><ul><li>引入了 Diffusion Transformers (DiTs)，一个为diffusion模型设计的基于transformer的backbone，明显优于U-Net作为backbone的模型。</li><li>取得了SOTA结果，未来可以将DiT扩展到更大的模型和更多的token数量。DiT也可以直接作为 DALL·E 2h或者Stable Diffusion直接骨干。</li></ul><h1><span id="fu-lu">附录</span><a href="#fu-lu" class="header-anchor"></a></h1><h2><span id="adaln-mo-kuai-ji-qi-bian-ti-adaln-zero-xiang-jie-yu-tui-dao">adaLN模块及其变体adaLN-Zero详解与推导</span><a href="#adaln-mo-kuai-ji-qi-bian-ti-adaln-zero-xiang-jie-yu-tui-dao" class="header-anchor"></a></h2><p>在<strong>Diffusion Transformer (DiT)</strong> 模型中，<strong>自适应层归一化（adaLN）</strong>模块及其变体<strong>adaLN-Zero</strong>在提升模型性能和计算效率方面发挥了关键作用。</p><h3><span id="yi-biao-zhun-ceng-gui-yi-hua-layer-norm">一、标准层归一化（Layer Norm）</span><a href="#yi-biao-zhun-ceng-gui-yi-hua-layer-norm" class="header-anchor"></a></h3><p>在讨论自适应层归一化之前，首先回顾标准的层归一化方法。</p><p><strong>标准层归一化公式：</strong></p><p>给定输入向量<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.09ex" xmlns="http://www.w3.org/2000/svg" width="6.792ex" height="2.022ex" role="img" focusable="false" viewbox="0 -853.7 3002.3 893.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(884.8,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(1829.6,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,363) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></g></svg></mjx-container></span>，层归一化（Layer Norm）的计算过程如下：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-10.989ex" xmlns="http://www.w3.org/2000/svg" width="32.109ex" height="23.109ex" role="img" focusable="false" viewbox="0 -5357.1 14192.2 10214.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,3616.4)"><g data-mml-node="mtd" transform="translate(5746,0)"><g data-mml-node="mi"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g></g><g data-mml-node="mtd" transform="translate(6349,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(1333.6,0)"><g data-mml-node="mn" transform="translate(230,676)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-686)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><rect width="720" height="60" x="120" y="220"/></g><g data-mml-node="munderover" transform="translate(2460.2,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761 1235 809 1174 838T1033 881 882 898 699 902H574 543 251L259 891Q722 258 724 252 725 250 724 246 721 243 460-56L196-356Q196-357 407-357 459-357 548-357T676-358Q812-358 896-353T1063-332 1204-283 1307-196Q1328-170 1348-124H1388Q1388-125 1381-145T1356-210 1325-294L1267-449 666-450Q64-450 61-448 55-446 55-439 55-437 57-433L590 177Q590 178 557 222T452 366 322 544L56 909 55 924Q55 945 60 948Z"/></g><g data-mml-node="TeXAtom" transform="translate(148.2,-1087.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369 98 420 158 442Q197 442 223 419T250 357Q250 340 236 301T196 196 154 83Q149 61 149 51 149 26 166 26 175 26 185 29T208 43 235 78 260 137Q263 149 265 151T282 153Q302 153 302 143 302 135 293 112T268 61 223 11 161-11Q129-11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281 56 279 53 278 49 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(538.2,1150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g><g data-mml-node="msub" transform="translate(4070.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369 98 420 158 442Q197 442 223 419T250 357Q250 340 236 301T196 196 154 83Q149 61 149 51 149 26 166 26 175 26 185 29T208 43 235 78 260 137Q263 149 265 151T282 153Q302 153 302 143 302 135 293 112T268 61 223 11 161-11Q129-11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281 56 279 53 278 49 278 41 278H27Q21 284 21 287Z"/></g></g></g></g><g data-mml-node="mtr" transform="translate(0,329.8)"><g data-mml-node="mtd" transform="translate(5341.4,0)"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184-11Q116-11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427 562 425 565 422 567 420 569 416 570 412 571 407 572 401Q572 357 507 357 500 357 490 357T476 358H416L421 348Q439 310 439 263 439 153 359 71T184-11ZM361 278Q361 358 276 358 152 358 115 184 114 180 114 178 106 141 106 117 106 67 131 47T188 26Q242 26 287 73 316 103 334 153T356 233 361 278Z"/></g><g data-mml-node="mn" transform="translate(604,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g><g data-mml-node="mtd" transform="translate(6349,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(1333.6,0)"><g data-mml-node="mn" transform="translate(230,676)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-686)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><rect width="720" height="60" x="120" y="220"/></g><g data-mml-node="munderover" transform="translate(2460.2,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761 1235 809 1174 838T1033 881 882 898 699 902H574 543 251L259 891Q722 258 724 252 725 250 724 246 721 243 460-56L196-356Q196-357 407-357 459-357 548-357T676-358Q812-358 896-353T1063-332 1204-283 1307-196Q1328-170 1348-124H1388Q1388-125 1381-145T1356-210 1325-294L1267-449 666-450Q64-450 61-448 55-446 55-439 55-437 57-433L590 177Q590 178 557 222T452 366 322 544L56 909 55 924Q55 945 60 948Z"/></g><g data-mml-node="TeXAtom" transform="translate(148.2,-1087.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369 98 420 158 442Q197 442 223 419T250 357Q250 340 236 301T196 196 154 83Q149 61 149 51 149 26 166 26 175 26 185 29T208 43 235 78 260 137Q263 149 265 151T282 153Q302 153 302 143 302 135 293 112T268 61 223 11 161-11Q129-11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281 56 279 53 278 49 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578 200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641 273 663Q275 666 285 666 294 666 302 660V361L303 61Q310 54 315 52T339 48 401 46H427V0H416Q395 3 257 3 121 3 100 0H88V46H114Q136 46 152 46T177 47 193 50 201 52 207 57 213 61V578Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(538.2,1150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g><g data-mml-node="mo" transform="translate(3904.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="msub" transform="translate(4293.2,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442 467 442 494 420T522 361Q522 332 508 314T481 292 458 288Q439 288 427 299T415 328Q415 374 465 391 454 404 425 404 412 404 406 402 368 386 350 336 290 115 290 78 290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145 504 144 502 134 486 77 440 33T333-11Q263-11 227 52 186-10 133-10H127Q78-10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101 142 81 130 66T107 46 94 41L91 40Q91 39 97 36T113 29 132 26Q168 26 194 71 203 87 217 139T245 247 261 313Q266 340 266 352 266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369 98 420 158 442Q197 442 223 419T250 357Q250 340 236 301T196 196 154 83Q149 61 149 51 149 26 166 26 175 26 185 29T208 43 235 78 260 137Q263 149 265 151T282 153Q302 153 302 143 302 135 293 112T268 61 223 11 161-11Q129-11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281 56 279 53 278 49 278 41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mo" transform="translate(5414.4,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(6414.6,0)"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g><g data-mml-node="msup" transform="translate(7017.6,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-2475.1)"><g data-mml-node="mtd" transform="translate(5742,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g></g><g data-mml-node="mtd" transform="translate(6349,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(1333.6,0)"><g data-mml-node="mrow" transform="translate(748.3,676)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(829.2,0)"><path data-c="2212" d="M84 237T84 250 98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(1829.4,0)"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g></g><g data-mml-node="msqrt" transform="translate(220,-926.5)"><g transform="translate(853,0)"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184-11Q116-11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427 562 425 565 422 567 420 569 416 570 412 571 407 572 401Q572 357 507 357 500 357 490 357T476 358H416L421 348Q439 310 439 263 439 153 359 71T184-11ZM361 278Q361 358 276 358 152 358 115 184 114 180 114 178 106 141 106 117 106 67 131 47T188 26Q242 26 287 73 316 103 334 153T356 233 361 278Z"/></g><g data-mml-node="mn" transform="translate(604,289) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315 301 241Q265 210 201 149L142 93 218 92Q375 92 385 97 392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19 31Q50 38 56 46T86 81Q115 113 136 137 145 147 170 174T204 211 233 244 261 278 284 308 305 340 320 369 333 401 340 431 343 464Q343 527 309 573T212 619Q179 619 154 602T119 569 109 550Q109 549 114 549 132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g><g data-mml-node="mo" transform="translate(1229.8,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(2230,0)"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g></g><g data-mml-node="mo" transform="translate(0,106.5)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200 103 230 169 280 207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397-77Q398-77 501 136T707 565 814 786Q820 800 834 800 841 800 846 794T853 782V776L620 293 385-193Q381-200 366-200 357-200 354-197 352-195 256 15L160 225 144 214Q129 202 113 190T95 178Z"/></g><rect width="2636" height="60" x="853" y="846.5"/></g><rect width="3689" height="60" x="120" y="220"/></g></g></g><g data-mml-node="mtr" transform="translate(0,-4607.1)"><g data-mml-node="mtd"><g data-mml-node="mtext"><path data-c="4C" d="M128 622Q121 629 117 631T101 634 58 637H25V683H36Q48 680 182 680 324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52 243 47 313 47 384 47 410 53 470 70 498 110T536 221Q536 226 537 238T540 261 542 272 562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(625,0)"/><path data-c="79" d="M69-66Q91-66 104-80T118-116Q118-134 109-145T91-160Q84-163 97-166 104-168 111-168 131-168 148-159T175-138 197-106 213-75 225-43L242 0 170 183Q150 233 125 297 101 358 96 368T80 381Q79 382 78 382 66 385 34 385H19V431H26L46 430Q65 430 88 429T122 428Q129 428 142 428T171 429 200 430 224 430L233 431H241V385H232Q183 385 185 366L286 112Q286 113 332 227L376 341V350Q376 365 366 373T348 383 334 385H331V431H337 344Q351 431 361 431T382 430 405 429 422 429Q477 429 503 431H508V385H497Q441 380 422 345 420 343 378 235T289 9 227-131Q180-204 113-204 69-204 44-177T19-116Q19-89 35-78T69-66Z" transform="translate(1125,0)"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(1653,0)"/><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122 98 161 98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441 171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400 273 405Q271 407 250 401 234 393 226 386 179 341 179 207V154Q179 141 179 127T179 101 180 81 180 66V61Q181 59 183 57T188 54 193 51 200 49 207 48 216 47 225 47 235 46 245 46H276V0H267Q249 3 140 3 37 3 28 0H20V46H36Z" transform="translate(2097,0)"/><path data-c="4E" d="M42 46Q74 48 94 56T118 69 128 86V634H124Q114 637 52 637H25V683H232L235 680Q237 679 322 554T493 303L578 178V598Q572 608 568 613T544 627 492 637H475V683H483Q498 680 600 680 706 680 715 683H724V637H707Q634 633 622 598L621 302V6L614 0H600Q585 0 582 3T481 150 282 443 171 605V345L172 86Q183 50 257 46H274V0H265Q250 3 150 3 48 3 33 0H25V46H42Z" transform="translate(2489,0)"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(3239,0)"/><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122 98 161 98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441 171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400 273 405Q271 407 250 401 234 393 226 386 179 341 179 207V154Q179 141 179 127T179 101 180 81 180 66V61Q181 59 183 57T188 54 193 51 200 49 207 48 216 47 225 47 235 46 245 46H276V0H267Q249 3 140 3 37 3 28 0H20V46H36Z" transform="translate(3739,0)"/><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122 103 161 103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441 178 442H181V402Q181 364 182 364T187 369 199 384 218 402 247 421 285 437Q305 442 336 442 351 442 364 440T387 434 406 426 421 417 432 406 441 395 448 384 452 374 455 366L457 361 460 365Q463 369 466 373T475 384 488 397 503 410 523 422 546 432 572 439 603 442Q729 442 740 329 741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62 657 64 657 200 656 335 655 343 649 371 635 385T611 402 585 404Q540 404 506 370 479 343 472 315T464 232V168 108Q464 78 465 68T468 55 477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62 380 64 380 200 379 335 378 343 372 371 358 385T334 402 308 404Q263 404 229 370 202 343 195 315T187 232V168 108Q187 78 188 68T191 55 200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(4131,0)"/></g><g data-mml-node="mo" transform="translate(4964,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(5353,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(5960,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g><g data-mml-node="mtd" transform="translate(6349,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1333.6,0)"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g><g data-mml-node="mo" transform="translate(2098.8,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2599,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g><g data-mml-node="mo" transform="translate(3428.2,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4428.4,0)"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></g></g></g></svg></mjx-container></span></p><p>其中：<br>-<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.364ex" height="1.489ex" role="img" focusable="false" viewbox="0 -442 603 658"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58-216Q44-216 34-208T23-186Q23-176 96 116T173 414Q186 442 219 442 231 441 239 435T249 423 251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26 261 26 270 27T287 31 302 38 315 45 327 55 338 65 348 77 356 88 365 100L372 110 408 253Q444 395 448 404 461 431 491 431 504 431 512 424T523 412 525 402L449 84Q448 79 448 68 448 43 455 35T476 26Q485 27 496 35 517 55 537 131 543 151 547 152 549 153 557 153H561Q580 153 580 144 580 138 575 117T555 63 523 13Q510 0 491-8 483-10 467-10 446-10 429-4T402 11 385 29 376 44 374 51L368 45Q362 39 350 30T324 12 288-4 246-11Q199-11 153 12L129-85Q108-167 104-180T92-202Q76-216 58-216Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.292ex" height="1ex" role="img" focusable="false" viewbox="0 -431 571 442"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70E" d="M184-11Q116-11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427 562 425 565 422 567 420 569 416 570 412 571 407 572 401Q572 357 507 357 500 357 490 357T476 358H416L421 348Q439 310 439 263 439 153 359 71T184-11ZM361 278Q361 358 276 358 152 358 115 184 114 180 114 178 106 141 106 117 106 67 131 47T188 26Q242 26 287 73 316 103 334 153T356 233 361 278Z"/></g></g></g></svg></mjx-container></span>分别是输入向量<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.373ex" height="1.005ex" role="img" focusable="false" viewbox="0 -444 607 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g></g></g></svg></mjx-container></span>的均值和标准差。<br>-<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>是可学习的缩放参数和偏移参数。<br>-<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.919ex" height="1ex" role="img" focusable="false" viewbox="0 -431 406 442"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D716" d="M227-11Q149-11 95 41T40 174Q40 262 87 322 121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411 382 385 341 385H325 312Q191 385 154 277L150 265H327Q340 256 340 246 340 228 320 219H138V217Q128 187 128 143 128 77 160 52T231 26Q258 26 284 36T326 57 343 68Q350 68 354 58T358 39Q358 36 357 35 354 31 337 21T289 0 227-11Z"/></g></g></g></svg></mjx-container></span>是一个小常数，防止数值不稳定。</p><p><strong>标准层归一化的特点：</strong></p><ul><li><strong>固定参数</strong>：<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>是在训练过程中学习得到的固定参数，与输入的条件信息无关。</li><li><strong>适用于所有样本</strong>：同一层的归一化参数在所有输入样本中共享。</li></ul><h3><span id="er-zi-gua-ying-ceng-gui-yi-hua-adaptive-layer-norm-adaln">二、自适应层归一化（Adaptive Layer Norm, adaLN）</span><a href="#er-zi-gua-ying-ceng-gui-yi-hua-adaptive-layer-norm-adaln" class="header-anchor"></a></h3><p><strong>引入自适应层归一化的动机：</strong></p><p>在条件生成任务中（如扩散模型），希望生成的样本能够依据条件信息进行调整。标准层归一化中的固定<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>无法动态适应不同的条件信息，因此引入了<strong>自适应层归一化（adaLN）</strong>。</p><p><strong>自适应层归一化的基本思想：</strong></p><p>将归一化的缩放参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和偏移参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>从固定参数转变为条件依赖的动态参数，即通过条件信息<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewbox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>的嵌入向量来预测<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>。</p><p><strong>adaLN的具体公式：</strong></p><ol type="1"><li><p><strong>条件信息的嵌入：</strong></p><p>首先，将时间步<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewbox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></svg></mjx-container></span>和条件<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>分别通过嵌入层<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="4.305ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 1903 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(1514,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="4.468ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 1975 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(764,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1153,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(1586,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span>转换为向量：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-2.384ex" xmlns="http://www.w3.org/2000/svg" width="15.637ex" height="5.899ex" role="img" focusable="false" viewbox="0 -1553.7 6911.7 2607.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,650)"><g data-mml-node="mtd" transform="translate(50.9,0)"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g><g data-mml-node="mtd" transform="translate(916.2,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1333.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(2097.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2486.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(2847.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3514.3,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(4459.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(755,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350 174 402 244 433 307 442H310Q355 442 388 420T421 355Q421 265 310 237 261 224 176 223 139 223 138 221 138 219 132 186T125 128Q125 81 146 54T209 26 302 45 394 111Q403 121 406 121 410 121 419 112T429 98 420 82 390 55 344 24 281-1 205-11Q126-11 83 42T39 168ZM373 353Q367 405 305 405 272 405 244 391T199 357 170 316 154 280 149 261Q149 260 169 260 282 260 327 284T373 353Z"/></g></g></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-803.7)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g><g data-mml-node="mtd" transform="translate(916.2,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(1333.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226 472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272 690 274 698 274 718 274 718 261 613 7 608 2 605 0 322 0H133Q31 0 31 11 31 13 34 25 38 41 42 43T65 46Q92 46 125 49 139 52 144 61 146 66 215 342T285 622Q285 629 281 629 273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669 764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528 704 558 697 578T678 609 643 625 596 632 532 634H485Q397 633 392 631 388 629 386 622 385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492 572 491 574 487 577 483L544 351Q511 218 508 216 505 213 492 213Z"/></g><g data-mml-node="mo" transform="translate(2097.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2486.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(2919.6,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3586.3,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(4531.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(755,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350 174 402 244 433 307 442H310Q355 442 388 420T421 355Q421 265 310 237 261 224 176 223 139 223 138 221 138 219 132 186T125 128Q125 81 146 54T209 26 302 45 394 111Q403 121 406 121 410 121 419 112T429 98 420 82 390 55 344 24 281-1 205-11Q126-11 83 42T39 168ZM373 353Q367 405 305 405 272 405 244 391T199 357 170 316 154 280 149 261Q149 260 169 260 282 260 327 284T373 353Z"/></g></g></g></g></g></g></g></g></g></svg></mjx-container></span></p></li><li><p><strong>合并条件信息：</strong></p><p>将<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="1.958ex" height="1.38ex" role="img" focusable="false" viewbox="0 -452 865.3 609.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="2.073ex" height="1.38ex" role="img" focusable="false" viewbox="0 -452 916.2 609.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></g></svg></mjx-container></span>相加，得到综合条件向量：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="17.085ex" height="2.402ex" role="img" focusable="false" viewbox="0 -903.7 7551.4 1061.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mo" transform="translate(804.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(1860.6,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g><g data-mml-node="mo" transform="translate(2948,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="msub" transform="translate(3948.3,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mi" transform="translate(560,-150) scale(0.707)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g><g data-mml-node="mo" transform="translate(5142.2,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(6087,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(755,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350 174 402 244 433 307 442H310Q355 442 388 420T421 355Q421 265 310 237 261 224 176 223 139 223 138 221 138 219 132 186T125 128Q125 81 146 54T209 26 302 45 394 111Q403 121 406 121 410 121 419 112T429 98 420 82 390 55 344 24 281-1 205-11Q126-11 83 42T39 168ZM373 353Q367 405 305 405 272 405 244 391T199 357 170 316 154 280 149 261Q149 260 169 260 282 260 327 284T373 353Z"/></g></g></g></g></g></g></svg></mjx-container></span></p></li><li><p><strong>回归缩放参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和偏移参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>：</strong></p><p>利用一个回归网络（通常是一个小型的全连接网络或多层感知机，MLP来生成<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.685ex" xmlns="http://www.w3.org/2000/svg" width="29.653ex" height="2.73ex" role="img" focusable="false" viewbox="0 -903.7 13106.8 1206.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g><g data-mml-node="mo" transform="translate(820.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(1876.6,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118-162Q120-162 124-164T135-167 147-168Q160-168 171-155T187-126Q197-99 221 27T267 267 289 382V385H242Q195 385 192 387 188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432 298 434 307 482T319 540Q356 705 465 705 502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603 443 622 454 636T478 657L487 662Q471 668 457 668 445 668 434 658T419 630Q412 601 403 552T387 469 380 433Q380 431 435 431 480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282-47 255-132 212-173 175-205 139-205 107-205 81-186T55-132Q55-95 76-78T118-61Q162-61 162-103 162-122 151-136T127-157L118-162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g><g data-mml-node="mo" transform="translate(2833.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3222.5,0)"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mo" transform="translate(3749.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4416.3,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(5361.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,413) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g><g data-mml-node="mspace" transform="translate(6533.8,0)"/><g data-mml-node="mi" transform="translate(6533.8,0)"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g><g data-mml-node="mo" transform="translate(7377.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(8433.3,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118-162Q120-162 124-164T135-167 147-168Q160-168 171-155T187-126Q197-99 221 27T267 267 289 382V385H242Q195 385 192 387 188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432 298 434 307 482T319 540Q356 705 465 705 502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603 443 622 454 636T478 657L487 662Q471 668 457 668 445 668 434 658T419 630Q412 601 403 552T387 469 380 433Q380 431 435 431 480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282-47 255-132 212-173 175-205 139-205 107-205 81-186T55-132Q55-95 76-78T118-61Q162-61 162-103 162-122 151-136T127-157L118-162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g><g data-mml-node="mo" transform="translate(9406.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(9795.5,0)"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mo" transform="translate(10322.5,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(10989.3,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(11934.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,413) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></g></svg></mjx-container></span></p></li><li><p><strong>应用自适应层归一化：</strong></p><p>将动态生成的<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>应用于层归一化：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="24.873ex" height="2.403ex" role="img" focusable="false" viewbox="0 -812 10993.8 1062"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z"/><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693 454 694H457V390Q457 84 458 81 461 61 472 55T517 46H535V0Q533 0 459-5T380-11H373V44L365 37Q307-11 235-11 158-11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405 211 405 173 369 146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26 322 26 373 103V342Z" transform="translate(500,0)"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(1056,0)"/><path data-c="4C" d="M128 622Q121 629 117 631T101 634 58 637H25V683H36Q48 680 182 680 324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52 243 47 313 47 384 47 410 53 470 70 498 110T536 221Q536 226 537 238T540 261 542 272 562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" transform="translate(1556,0)"/><path data-c="4E" d="M42 46Q74 48 94 56T118 69 128 86V634H124Q114 637 52 637H25V683H232L235 680Q237 679 322 554T493 303L578 178V598Q572 608 568 613T544 627 492 637H475V683H483Q498 680 600 680 706 680 715 683H724V637H707Q634 633 622 598L621 302V6L614 0H600Q585 0 582 3T481 150 282 443 171 605V345L172 86Q183 50 257 46H274V0H265Q250 3 150 3 48 3 33 0H25V46H42Z" transform="translate(2181,0)"/></g><g data-mml-node="mo" transform="translate(2931,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3320,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(3927,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(4371.7,0)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(4732.7,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(5177.3,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(5610.3,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(6277.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(7332.9,0)"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g><g data-mml-node="mo" transform="translate(8098.1,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(8598.3,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g><g data-mml-node="mo" transform="translate(9427.6,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(10427.8,0)"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span></p><p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.373ex" height="1.837ex" role="img" focusable="false" viewbox="0 -812 607 812"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g></g></g></svg></mjx-container></span>是标准层归一化的归一化结果。</p></li></ol><p><strong>自适应层归一化的特点：</strong></p><ul><li><strong>动态调整参数</strong>：归一化参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>随条件信息<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewbox="0 -626 361 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 433 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g></g></g></svg></mjx-container></span>动态变化，使模型能根据不同条件调整输出。</li><li><strong>计算效率高</strong>：相比其他条件机制（如条件批归一化），adaLN在计算量上更为高效，因为它只需少量参数来回归<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>。</li></ul><h3><span id="san-adaln-zero-mo-kuai">三、adaLN-Zero 模块</span><a href="#san-adaln-zero-mo-kuai" class="header-anchor"></a></h3><p><strong>引入adaLN-Zero的动机：</strong></p><p>在深度神经网络（如ResNets）的训练中，初始化残差块为恒等函数可以提升训练稳定性和加速收敛。</p><p><strong>adaLN-Zero的具体实现和推导：</strong></p><ol type="1"><li><p><strong>基础结构：</strong></p><p>在adaLN-Zero模块中，除了回归<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>外，还回归一个新的参数<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></svg></mjx-container></span>，用于在残差连接之前进行缩放：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="15.157ex" height="2.61ex" role="img" focusable="false" viewbox="0 -903.7 6699.4 1153.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(917.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msub" transform="translate(1973.6,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118-162Q120-162 124-164T135-167 147-168Q160-168 171-155T187-126Q197-99 221 27T267 267 289 382V385H242Q195 385 192 387 188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432 298 434 307 482T319 540Q356 705 465 705 502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603 443 622 454 636T478 657L487 662Q471 668 457 668 445 668 434 658T419 630Q412 601 403 552T387 469 380 433Q380 431 435 431 480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282-47 255-132 212-173 175-205 139-205 107-205 81-186T55-132Q55-95 76-78T118-61Q162-61 162-103 162-122 151-136T127-157L118-162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g><g data-mml-node="mo" transform="translate(2999.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3388.1,0)"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g><g data-mml-node="mo" transform="translate(3915.1,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4581.9,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(5526.7,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,413) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></g></svg></mjx-container></span></p></li><li><p><strong>初始化策略：</strong></p><p>将<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.464ex" xmlns="http://www.w3.org/2000/svg" width="2.32ex" height="2.059ex" role="img" focusable="false" viewbox="0 -705 1025.5 910"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D453" d="M118-162Q120-162 124-164T135-167 147-168Q160-168 171-155T187-126Q197-99 221 27T267 267 289 382V385H242Q195 385 192 387 188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432 298 434 307 482T319 540Q356 705 465 705 502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603 443 622 454 636T478 657L487 662Q471 668 457 668 445 668 434 658T419 630Q412 601 403 552T387 469 380 433Q380 431 435 431 480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282-47 255-132 212-173 175-205 139-205 107-205 81-186T55-132Q55-95 76-78T118-61Q162-61 162-103 162-122 151-136T127-157L118-162Z"/></g><g data-mml-node="TeXAtom" transform="translate(523,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></g></g></svg></mjx-container></span>的输出初始化为零向量，即使得在训练开始时：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="11.185ex" height="2.23ex" role="img" focusable="false" viewbox="0 -903.7 4943.8 985.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(917.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1973.6,0)"><g data-mml-node="mn"><path data-c="1D7CE" d="M266 654H280 282Q500 654 524 418 529 370 529 320 529 125 456 52 397-10 287-10 110-10 63 154 45 212 45 316 45 504 113 585 140 618 185 636T266 654ZM374 548Q347 604 286 604 247 604 218 575 197 552 193 511T188 311Q188 159 196 116 202 87 225 64T287 41Q339 41 367 87 379 107 382 152T386 329Q386 518 374 548Z"/></g></g><g data-mml-node="mo" transform="translate(2826.3,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540 469 540H568Q583 532 583 520 583 511 570 501L466 500Q355 499 329 494 280 482 242 458T183 409 147 354 129 306 124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112 231 48 328 7Q355 1 466 0H570Q583-10 583-20 583-32 568-40H471Q464-40 446-40T417-41Q262-41 172 45 84 127 84 250Z"/></g><g data-mml-node="msup" transform="translate(3771.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677 461 673 481 667T516 654 544 639 566 623 584 607 597 592 607 578 614 565 618 554L621 548Q626 530 626 497 626 447 613 419 578 348 473 326L455 321Q462 310 473 292T517 226 578 141 637 72 686 35Q705 30 705 16 705 7 693-1H510Q503 6 404 159L306 310H268V183Q270 67 271 59 274 42 291 38 295 37 319 35 344 35 353 28 362 17 353 3L346-1H28Q16 5 16 16 16 35 55 35 96 38 101 52 106 60 106 341T101 632Q95 645 55 648 17 648 17 665ZM241 35Q238 42 237 45T235 78 233 163 233 337V621L237 635 244 648H133Q136 641 137 638T139 603 141 517 141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615 400 634 377 643Q374 643 339 648 300 648 281 635 271 628 270 610T268 481V346H284Q327 346 375 352 421 364 439 392T457 496ZM492 537T492 496 488 427 478 389 469 371 464 361Q464 360 465 360 469 360 497 370 593 400 593 495 593 592 477 630L457 637 461 626Q474 611 488 561 492 537 492 496ZM464 243Q411 317 410 317 404 317 401 315 384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"/></g></g><g data-mml-node="mi" transform="translate(755,413) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686 523 679 450 384T375 83 374 68Q374 26 402 26 411 27 422 35 443 55 463 131 469 151 473 152 475 153 483 153H487 491Q506 153 506 145 506 140 503 129 490 79 473 48T445 8 417-8Q409-10 393-10 359-10 336 5T306 36L300 51Q299 52 296 50 294 48 292 46 233-10 172-10 117-10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400 369 394 369 396 370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405 242 405 210 374T160 293Q131 214 119 129 119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109 352 326Z"/></g></g></g></g></svg></mjx-container></span></p><p>这样，在初始阶段：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="18.83ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 8323 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(862.2,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="mtext" transform="translate(1362.4,0)"><path data-c="52" d="M130 622Q123 629 119 631T103 634 60 637H27V683H202 236 300Q376 683 417 677T500 648Q595 600 609 517 610 512 610 501 610 468 594 439T556 392 511 361 472 343L456 338Q459 335 467 332 497 316 516 298T545 254 559 211 568 155 578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105 728 103 732 90Q732 59 716 27T672-16Q656-22 630-22 481-16 458 90 456 101 456 163T449 246Q430 304 373 320L363 322 297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3 59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570 462 601 424 623 362 636Q360 636 340 636T304 637H283Q238 637 234 628 231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(736,0)"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401 98 382 98 349 97 344 98 336T114 312 157 287Q175 282 201 278T245 269 277 256Q294 248 310 236T342 195 359 133Q359 71 321 31T198-10H190Q138-10 94 26L86 19 77 10Q71 4 65-1L54-11H46 42Q39-11 33-5V74 132Q33 153 35 157T45 162H54Q66 162 70 158T75 146 82 119 101 77Q136 26 198 26 295 26 295 104 295 133 277 151 257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424 143 442 187 447H198Q238 447 268 432L283 424 292 431Q302 440 314 448H322 326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1180,0)"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3 132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49 100 53 102 60T104 102V205 293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441 182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(1574,0)"/><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693 454 694H457V390Q457 84 458 81 461 61 472 55T517 46H535V0Q533 0 459-5T380-11H373V44L365 37Q307-11 235-11 158-11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405 211 405 173 369 146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26 322 26 373 103V342Z" transform="translate(1852,0)"/><path data-c="75" d="M383 58Q327-10 256-10H249Q124-10 105 89 104 96 103 226 102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441 184 442H187V261Q188 77 190 64 193 49 204 40 224 26 264 26 290 26 311 35T343 58 363 90 375 120 379 144Q379 145 379 161T380 201 380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81 468 61 479 55T524 46H542V0Q540 0 467-5T390-11H383V58Z" transform="translate(2408,0)"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(2964,0)"/><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z" transform="translate(3464,0)"/></g><g data-mml-node="mo" transform="translate(5104.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(5493.4,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(6100.4,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(6767.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(7823,0)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></svg></mjx-container></span></p><p>即无论残差连接中的内容如何，初始的残差连接对输出不会产生影响，整个adaLN-Zero模块表现为恒等映射。</p></li><li><p><strong>残差连接中的应用：</strong></p><p>假设一个Transformer块中的输入为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.373ex" height="1.005ex" role="img" focusable="false" viewbox="0 -444 607 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g></g></g></svg></mjx-container></span>，经过adaLN-Zero模块后的输出为：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="40.57ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 17931.8 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D432" d="M84-102Q84-110 87-119T102-138 133-149Q148-148 162-143T186-131 206-114 222-95 234-76 243-59 249-45 252-37L269 0 96 382H26V444H34Q49 441 146 441 252 441 270 444H279V382H255Q232 382 232 380L337 151 442 382H394V444H401Q413 441 495 441 568 441 574 444H580V382H510L406 152Q298-84 297-87 269-139 225-169T131-200Q85-200 54-172T23-100Q23-64 44-50T87-35Q111-35 130-50T152-92V-100H84V-102Z"/></g></g><g data-mml-node="mo" transform="translate(884.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mtext" transform="translate(1940.6,0)"><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z"/><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693 454 694H457V390Q457 84 458 81 461 61 472 55T517 46H535V0Q533 0 459-5T380-11H373V44L365 37Q307-11 235-11 158-11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405 211 405 173 369 146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26 322 26 373 103V342Z" transform="translate(500,0)"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(1056,0)"/><path data-c="4C" d="M128 622Q121 629 117 631T101 634 58 637H25V683H36Q48 680 182 680 324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52 243 47 313 47 384 47 410 53 470 70 498 110T536 221Q536 226 537 238T540 261 542 272 562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" transform="translate(1556,0)"/><path data-c="4E" d="M42 46Q74 48 94 56T118 69 128 86V634H124Q114 637 52 637H25V683H232L235 680Q237 679 322 554T493 303L578 178V598Q572 608 568 613T544 627 492 637H475V683H483Q498 680 600 680 706 680 715 683H724V637H707Q634 633 622 598L621 302V6L614 0H600Q585 0 582 3T481 150 282 443 171 605V345L172 86Q183 50 257 46H274V0H265Q250 3 150 3 48 3 33 0H25V46H42Z" transform="translate(2181,0)"/><path data-c="2D" d="M11 179V252H277V179H11Z" transform="translate(2931,0)"/><path data-c="5A" d="M69 443Q69 452 74 554T80 683H549Q555 677 555 664 555 649 554 648 552 645 366 348T179 50 192 49 263 49H275 302Q333 49 353 50T401 59 447 78 482 115 507 173Q513 200 520 273V282H560V274Q560 272 552 143T543 8V0H302L61 1 58 3Q55 8 55 21V35Q59 43 153 193T340 489 432 637H343Q259 637 214 625T141 573Q109 523 109 445 109 443 89 443H69Z" transform="translate(3264,0)"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(3875,0)"/><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122 98 161 98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441 171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400 273 405Q271 407 250 401 234 393 226 386 179 341 179 207V154Q179 141 179 127T179 101 180 81 180 66V61Q181 59 183 57T188 54 193 51 200 49 207 48 216 47 225 47 235 46 245 46H276V0H267Q249 3 140 3 37 3 28 0H20V46H36Z" transform="translate(4319,0)"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(4711,0)"/></g><g data-mml-node="mo" transform="translate(7151.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7540.6,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(8147.6,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(8592.2,0)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(8953.2,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(9397.9,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(9830.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(10442.1,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(11442.3,0)"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(12304.6,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="mtext" transform="translate(12804.8,0)"><path data-c="52" d="M130 622Q123 629 119 631T103 634 60 637H27V683H202 236 300Q376 683 417 677T500 648Q595 600 609 517 610 512 610 501 610 468 594 439T556 392 511 361 472 343L456 338Q459 335 467 332 497 316 516 298T545 254 559 211 568 155 578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105 728 103 732 90Q732 59 716 27T672-16Q656-22 630-22 481-16 458 90 456 101 456 163T449 246Q430 304 373 320L363 322 297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3 59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570 462 601 424 623 362 636Q360 636 340 636T304 637H283Q238 637 234 628 231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(736,0)"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401 98 382 98 349 97 344 98 336T114 312 157 287Q175 282 201 278T245 269 277 256Q294 248 310 236T342 195 359 133Q359 71 321 31T198-10H190Q138-10 94 26L86 19 77 10Q71 4 65-1L54-11H46 42Q39-11 33-5V74 132Q33 153 35 157T45 162H54Q66 162 70 158T75 146 82 119 101 77Q136 26 198 26 295 26 295 104 295 133 277 151 257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424 143 442 187 447H198Q238 447 268 432L283 424 292 431Q302 440 314 448H322 326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1180,0)"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3 132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49 100 53 102 60T104 102V205 293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441 182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(1574,0)"/><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693 454 694H457V390Q457 84 458 81 461 61 472 55T517 46H535V0Q533 0 459-5T380-11H373V44L365 37Q307-11 235-11 158-11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405 211 405 173 369 146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26 322 26 373 103V342Z" transform="translate(1852,0)"/><path data-c="75" d="M383 58Q327-10 256-10H249Q124-10 105 89 104 96 103 226 102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441 184 442H187V261Q188 77 190 64 193 49 204 40 224 26 264 26 290 26 311 35T343 58 363 90 375 120 379 144Q379 145 379 161T380 201 380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81 468 61 479 55T524 46H542V0Q540 0 467-5T390-11H383V58Z" transform="translate(2408,0)"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(2964,0)"/><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124 104 167 104 217 104 272 104 329Q104 366 104 407T104 482 104 542 103 586 103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693 182 694H185V379Q185 62 186 60 190 52 198 49 219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3 107 3 57 1L34 0H26V46H42Z" transform="translate(3464,0)"/></g><g data-mml-node="mo" transform="translate(16546.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(16935.8,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(17542.8,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g></g></g></svg></mjx-container></span></p><p>在初始阶段，由于<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="5.596ex" height="1.692ex" role="img" focusable="false" viewbox="0 -666 2473.6 748"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g><g data-mml-node="mo" transform="translate(917.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1973.6,0)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></svg></mjx-container></span>，有：</p><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="38.319ex" height="2.403ex" role="img" focusable="false" viewbox="0 -812 16936.8 1062"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D432" d="M84-102Q84-110 87-119T102-138 133-149Q148-148 162-143T186-131 206-114 222-95 234-76 243-59 249-45 252-37L269 0 96 382H26V444H34Q49 441 146 441 252 441 270 444H279V382H255Q232 382 232 380L337 151 442 382H394V444H401Q413 441 495 441 568 441 574 444H580V382H510L406 152Q298-84 297-87 269-139 225-169T131-200Q85-200 54-172T23-100Q23-64 44-50T87-35Q111-35 130-50T152-92V-100H84V-102Z"/></g></g><g data-mml-node="mo" transform="translate(884.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mtext" transform="translate(1940.6,0)"><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z"/><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693 454 694H457V390Q457 84 458 81 461 61 472 55T517 46H535V0Q533 0 459-5T380-11H373V44L365 37Q307-11 235-11 158-11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405 211 405 173 369 146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26 322 26 373 103V342Z" transform="translate(500,0)"/><path data-c="61" d="M137 305T115 305 78 320 63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59 481 29 455 12T400-6 353 12 329 54V58L327 55Q325 52 322 49T314 40 302 29 287 17 269 6 247-2 221-8 190-11Q130-11 82 20T34 107Q34 128 41 147T68 188 116 225 194 253 304 268H318V290Q318 324 312 340 290 411 215 411 197 411 181 410T156 406 148 403Q170 388 170 359 170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175 318 233 317 233 309 233 296 232T251 223 193 203 147 166 126 106Z" transform="translate(1056,0)"/><path data-c="4C" d="M128 622Q121 629 117 631T101 634 58 637H25V683H36Q48 680 182 680 324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52 243 47 313 47 384 47 410 53 470 70 498 110T536 221Q536 226 537 238T540 261 542 272 562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" transform="translate(1556,0)"/><path data-c="4E" d="M42 46Q74 48 94 56T118 69 128 86V634H124Q114 637 52 637H25V683H232L235 680Q237 679 322 554T493 303L578 178V598Q572 608 568 613T544 627 492 637H475V683H483Q498 680 600 680 706 680 715 683H724V637H707Q634 633 622 598L621 302V6L614 0H600Q585 0 582 3T481 150 282 443 171 605V345L172 86Q183 50 257 46H274V0H265Q250 3 150 3 48 3 33 0H25V46H42Z" transform="translate(2181,0)"/><path data-c="2D" d="M11 179V252H277V179H11Z" transform="translate(2931,0)"/><path data-c="5A" d="M69 443Q69 452 74 554T80 683H549Q555 677 555 664 555 649 554 648 552 645 366 348T179 50 192 49 263 49H275 302Q333 49 353 50T401 59 447 78 482 115 507 173Q513 200 520 273V282H560V274Q560 272 552 143T543 8V0H302L61 1 58 3Q55 8 55 21V35Q59 43 153 193T340 489 432 637H343Q259 637 214 625T141 573Q109 523 109 445 109 443 89 443H69Z" transform="translate(3264,0)"/><path data-c="65" d="M28 218Q28 273 48 318T98 391 163 433 229 448Q282 448 320 430T378 380 406 316 415 245Q415 238 408 231H126V216Q126 68 226 36 246 30 270 30 312 30 342 62 359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121 415 117 412 108 393 53 349 21T250-11Q155-11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402 166 381 143 340 127 274V267H333V275Z" transform="translate(3875,0)"/><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122 98 161 98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441 171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400 273 405Q271 407 250 401 234 393 226 386 179 341 179 207V154Q179 141 179 127T179 101 180 81 180 66V61Q181 59 183 57T188 54 193 51 200 49 207 48 216 47 225 47 235 46 245 46H276V0H267Q249 3 140 3 37 3 28 0H20V46H36Z" transform="translate(4319,0)"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250-10Q153-10 91 57T28 214ZM250 30Q372 30 372 193V225 250Q372 272 371 288T364 326 348 362 317 390 268 410Q263 411 252 411 222 411 195 399 152 377 139 338T126 246V226Q126 130 145 91 177 30 250 30Z" transform="translate(4711,0)"/></g><g data-mml-node="mo" transform="translate(7151.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488 164 576 202 643 244 695 277 729 302 750H315 319Q333 750 333 741 333 738 316 720T275 667 226 581 184 443 167 250 184 58 225-81 274-167 316-220 333-241Q333-250 318-250H315 302L274-226Q180-141 137-14T94 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7540.6,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(8147.6,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(8592.2,0)"><path data-c="1D461" d="M26 385Q19 392 19 395 19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566 179 586 187 603 197 615 211 624 229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420 330 398 317 385H210L174 240Q135 80 135 68 135 26 162 26 197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145 322 142 319 133 314 117 301 95T267 48 216 6 155-11Q125-11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383 128 385 77 385H26Z"/></g><g data-mml-node="mo" transform="translate(8953.2,0)"><path data-c="2C" d="M78 35T78 60 94 103 137 121Q165 121 187 96T210 8Q210-27 201-60T180-117 154-158 130-185 117-194Q113-194 104-185T95-172Q95-168 106-156T131-126 157-76 173-3V9L172 8Q170 7 167 6T161 3 152 1 140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(9397.9,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325 330 359 352 380 366 386H367Q367 388 361 392T340 400 306 404Q276 404 249 390 228 381 206 359 162 315 142 235T121 119Q121 73 147 50 169 26 205 26H209Q321 26 394 111 403 121 406 121 410 121 419 112T429 98 420 83 391 55 346 25 282 0 202-11Q127-11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(9830.9,0)"><path data-c="29" d="M60 749 64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12 224-76 186-143 145-194 113-227 90-246Q87-249 86-250H74Q66-250 63-250T58-247 55-238Q56-237 66-225 221-64 221 250T66 725Q56 737 55 738 55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(10442.1,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mn" transform="translate(11442.3,0)"><path data-c="30" d="M96 585Q152 666 249 666 297 666 345 640T423 548Q460 465 460 320 460 165 417 83 397 41 362 16T301-15 250-22Q224-22 198-16T137 16 82 83Q39 165 39 320 39 494 96 585ZM321 597Q291 629 250 629 208 629 178 597 153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16 290 16 318 46 347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g><g data-mml-node="mo" transform="translate(12220.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347 722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153 722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(13275.9,0)"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g><g data-mml-node="mo" transform="translate(14041.1,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190 96 207 78 250Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(14541.3,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3 40 3 28 0H21V62H117L245 213 109 382H26V444H34Q49 441 143 441 247 441 265 444H274V382H246L281 339Q315 297 316 297 320 297 354 341L389 382H352V444H360Q375 441 466 441 547 441 559 444H566V382H471L355 246 504 63 545 62H586V0H578Q563 3 469 3 365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63 217 62H235V0H227Z"/></g></g><g data-mml-node="mo" transform="translate(303.5,18) translate(-250 0)"><path data-c="5E" d="M112 560 249 694 257 686Q387 562 387 560L361 531Q359 532 303 581L250 627 195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"/></g></g></g><g data-mml-node="mo" transform="translate(15370.6,0)"><path data-c="2B" d="M56 237T56 250 70 270H369V420L370 570Q380 583 389 583 402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401-82 391-82H389 387Q375-82 369-68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(16370.8,0)"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span></p><p>进一步，由于<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>也是通过<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.014ex" xmlns="http://www.w3.org/2000/svg" width="1.192ex" height="1.036ex" role="img" focusable="false" viewbox="0 -452 527 458"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g></g></g></svg></mjx-container></span>回归得到的，并且在初始阶段如果<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.014ex" xmlns="http://www.w3.org/2000/svg" width="1.192ex" height="1.036ex" role="img" focusable="false" viewbox="0 -452 527 458"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41E" d="M32 225Q32 332 102 392T272 452H283Q382 452 436 401 494 343 494 243 494 226 486 222T440 217Q431 217 394 217T327 218H175V209Q175 177 179 154T196 107 236 69 306 50Q312 49 323 49 376 49 410 85 421 99 427 111T434 127 442 133 463 135H468Q494 135 494 117 494 110 489 97T468 66 431 32 373 5 292-6Q181-6 107 55T32 225ZM383 276Q377 346 348 374T280 402Q253 402 230 390T195 357Q179 331 176 279V266H383V276Z"/></g></g></g></g></svg></mjx-container></span>被适当地初始化，也可以使得<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.489ex" xmlns="http://www.w3.org/2000/svg" width="1.229ex" height="1.486ex" role="img" focusable="false" viewbox="0 -441 543 657"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FE" d="M31 249Q11 249 11 258 11 275 26 304T66 365 129 418 206 441Q233 441 239 440 287 429 318 386T371 255Q385 195 385 170 385 166 386 166L398 193Q418 244 443 300T486 391 508 430Q510 431 524 431H537Q543 425 543 422 543 418 522 378T463 251 391 71Q385 55 378 6T357-100Q341-165 330-190T303-216Q286-216 286-188 286-138 340 32L346 51 347 69Q348 79 348 100 348 257 291 317 251 355 196 355 148 355 108 329T51 260Q49 251 47 251 45 249 31 249Z"/></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.281ex" height="2.034ex" role="img" focusable="false" viewbox="0 -705 566 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FD" d="M29-194Q23-188 23-186 23-183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252 533 139 448 65T257-10Q227-10 203-2T165 17 143 40 131 59 126 65L62-188Q60-194 42-194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439 461 453 472 471 484 495 493 524 501 560Q503 569 503 593 503 611 502 616 487 667 426 667 384 667 347 643T286 582 247 514 224 455Q219 439 186 308T152 168Q151 163 151 147 151 99 173 68 204 26 260 26 302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372 380 358 347 358H337Q258 358 258 389 258 396 261 403 275 431 353 431Z"/></g></g></g></svg></mjx-container></span>不会对输出产生过大影响。</p></li><li><p><strong>动态调整<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></svg></mjx-container></span>：</strong></p><p>在训练过程中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374 564 388 566 390T582 393Q603 393 603 385 603 376 594 346T558 261 497 161L486 147 487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62 597 56 591 43 579 19 556 5T512-10H505Q438-10 414 62L411 69 400 61Q390 53 370 41T325 18 267-2 203-11Q124-11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290 382 405 304 405 235 405 183 332 156 292 139 224T121 120Q121 71 146 49T208 26Z"/></g></g></g></svg></mjx-container></span>会逐步从零向量变为需要的缩放参数，使得残差连接逐渐起作用，从而实现模型参数的逐步优化。</p></li></ol><p><strong>adaLN-Zero的优势：</strong></p><ul><li><strong>训练稳定性</strong>：通过将残差块初始化为恒等映射，避免了初始阶段的梯度问题，提升了训练的稳定性。</li><li><strong>快速收敛</strong>：有助于加速大规模模型的训练过程，提高训练效率。</li><li><strong>计算效率高</strong>：与标准adaLN相似，adaLN-Zero增加的计算量（Gflops）极少，保持了高效性。</li></ul></div><div id="comment"><div id="waline-container"></div></div></div><footer id="footer"><div id="footer-wrap"><div>&copy; 2024 - 2024 Orion Blog<span id="footer-icon"><i class="fa-solid fa-font-awesome fa-fw"></i></span> &commat;Orion</div><div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a></div></div></footer></div><transition name="fade"><div id="preview" ref="preview" v-show="previewShow"><img id="preview-content" ref="previewContent"></div></transition></div><script src="/js/main.js"></script><script>Waline.init({el:"#waline-container",serverURL:"https://www.orionverse-comment.blog/",commentCount:!0,pageview:!0,emoji:"https://unpkg.com/@waline/emojis@1.0.1/weibo,https://unpkg.com/@waline/emojis@1.0.1/alus,https://unpkg.com/@waline/emojis@1.0.1/bilibili,https://unpkg.com/@waline/emojis@1.0.1/qq,https://unpkg.com/@waline/emojis@1.0.1/tieba,https://unpkg.com/@waline/emojis@1.0.1/tw-emoji".split(","),meta:"nick,mail,link".split(","),requiredMeta:"nick".split(","),lang:"zh-CN",wordLimit:0,pageSize:"10",login:"enable"})</script></body></html>